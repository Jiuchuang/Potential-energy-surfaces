*********************************************************************
*                                                                   *
*     LiH2 SURFACE EVALUATION ROUTINES FOR THE GROUND STATE 2A'     *
*     r(1)--rLiHa(a.u.)  r(2)--rHH(a.u.) r(3)--rLiHb(a.u.)          *
*     D is the corresponding derivative.The unit is a.u.            *
*     Vtot: Energy value in hartree                                 *
*     iD = 0: only calculate the energy value,not derivative        *
*        = 1: calculate the energy value and the derivative         *
*     Phys.Chem.Chem.Phys.,2015,17,11732-11739                      *
*                                                                   *
*********************************************************************   

      subroutine LiH2PES(r,Vtot,D,iD)
      implicit double precision (a-h,o-z)
	dimension r(3),D(3),r_t(3)
      
      if (iD.eq.0)then
          call VLiH2(r,Vtot)
      elseif(iD.eq.1)then
          call VLiH2(r,Vtot)
          h=0.00001d0


          r_t(1)=r(1)+2.0*h
          r_t(2)=r(2)
          r_t(3)=r(3)
          call VLiH2(r_t,V_p2h)

          r_t(1)=r(1)+h
          call VLiH2(r_t,V_p1h)
          
          r_t(1)=r(1)-h
          call VLiH2(r_t,V_n1h)
          
          r_t(1)=r(1)-2.0*h
          call VLiH2(r_t,V_n2h)

          D(1)=(-V_p2h+8.0*V_p1h-8.0*V_n1h+V_n2h)/(12.0*h)


          
          r_t(1)=r(1)
          r_t(2)=r(2)+2*h
          r_t(3)=r(3)
          call VLiH2(r_t,V_p2h)

          r_t(2)=r(2)+h
          call VLiH2(r_t,V_p1h)
          
          r_t(2)=r(2)-h
          call VLiH2(r_t,V_n1h)
          
          r_t(2)=r(2)-2.0*h
          call VLiH2(r_t,V_n2h)

          D(2)=(-V_p2h+8.0*V_p1h-8.0*V_n1h+V_n2h)/(12.0*h)

          
          r_t(1)=r(1)
          r_t(2)=r(2)
          r_t(3)=r(3)+2.0*h
          call VLiH2(r_t,V_p2h)

          r_t(3)=r(3)+h
          call VLiH2(r_t,V_p1h)
          
          r_t(3)=r(3)-h
          call VLiH2(r_t,V_n1h)
          
          r_t(3)=r(3)-2.0*h
          call VLiH2(r_t,V_n2h)

          D(3)=(-V_p2h+8.0*V_p1h-8.0*V_n1h+V_n2h)/(12.0*h)

      else
      stop 'WRONG iD!'
      endif
      

      end


	subroutine VLiH2(r,Vtot)
	implicit double precision (a-h,o-z)
	dimension r(3)

	call V3_QZ(r,V3_qz_EN)
	call V3_EXTR(r,V3_extr_EN)
	V3_EN=V3_qz_EN-V3_extr_EN
      
	
      call V2_HH(r(2),V2_HH_EN)
      call V2_LiH(r(1),V2_LiHa_EN)
      call V2_LiH(r(3),V2_LiHb_EN)
      V2_EN=V2_HH_EN+V2_LiHa_EN+V2_LiHb_EN
	
	rd=18.0d0
      rw=0.5d0

      vtot=V3_EN*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2_EN


	end


      subroutine V3_QZ(r,Vtot)
	implicit double precision (a-h,o-z)
	parameter (m= 11,n= 12)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.889872313857153707E+00,
     &   -0.172595866766531780E+01,
     &    0.248445385671633712E+00,
     &   -0.542995416615702187E+01,
     &    0.227424028490362451E+01,
     &   -0.308881120679323107E+00,
     &    0.127048207870024688E+01,
     &   -0.631203313938517763E+01,
     &    0.666353233720281946E+01,
     &    0.350111945009298919E+01,
     &   -0.190546802696493889E+01,
     &    0.229543015023585567E+00,
     &    0.353131179006677831E+01,
     &   -0.199661219062606810E+01,
     &   -0.367377016627486075E+01,
     &    0.419513080835111030E+01,
     &   -0.264543006536198799E+01,
     &    0.211366701902492626E+00,
     &   -0.273200785252858935E+01,
     &    0.188442333520059413E+01,
     &   -0.121795905455738207E+00,
     &   -0.341961719311308254E+01,
     &    0.301482357532132195E+01,
     &    0.157313644004020237E+01,
     &   -0.208440476417708187E+00,
     &   -0.143412591629889752E+01,
     &   -0.756029146336328201E-01,
     &    0.150828809661937596E+00,
     &    0.259353627099604589E+01,
     &    0.117010729478603040E-01,
     &    0.112504082496416058E+01,
     &    0.281185211584862449E+01,
     &   -0.222766051209253391E+01
     & /
      	data(bbi(i),i=1,m)/
     &    0.157291310810603130E+00,
     &    0.419558822436524714E+01,
     &    0.413418682010322502E+01,
     &   -0.135317022737510717E+01,
     &   -0.206934289942897170E+00,
     &   -0.184082686097700599E+01,
     &    0.738898249475936075E+00,
     &    0.244874169399637642E+01,
     &   -0.939719988250463989E+00,
     &    0.317765494577841867E+01,
     &    0.288852200270185611E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.151003462818043044E+02,
     &    0.564399811834781957E+02,
     &   -0.439230717675920523E+01,
     &    0.161991169130904353E+02,
     &    0.174500442410796008E+01,
     &   -0.205596822191650617E+02,
     &   -0.165560715839187225E+02,
     &   -0.932242490759284870E+01,
     &    0.228311682363638768E+01,
     &   -0.324994386613601023E+02,
     &   -0.871085857226585714E+00,
     &   -0.172359293513883283E+01,
     &    0.203100916688332384E+00,
     &   -0.108886429733976242E+01,
     &   -0.557110754279420917E+01,
     &   -0.452178425548605989E+00,
     &    0.525163388384716434E+01,
     &    0.281545947911062422E+01,
     &    0.393684705359956033E+00,
     &   -0.200778706435285148E+01,
     &    0.106435744282598570E+02,
     &    0.188300984462447640E+00,
     &   -0.993494204112897739E-01,
     &   -0.132285863042033665E+02,
     &   -0.407274789404453585E+01,
     &   -0.915034741052376255E+01,
     &   -0.351305181893095897E+00,
     &    0.911230964357751105E+01,
     &   -0.183163226202472329E+00,
     &    0.264452426673045249E+01,
     &   -0.165807847648857876E+01,
     &    0.359846994026363953E+01,
     &   -0.890032660358031746E+00,
     &    0.358109206557340465E+00,
     &   -0.148048471249924667E+02,
     &   -0.955626447213131613E+00,
     &   -0.796285331652719641E+01,
     &   -0.336449007972222436E+00,
     &    0.635975671172936519E+01,
     &   -0.316479595831537797E+01,
     &    0.264044709291577906E+01,
     &   -0.200148262001361976E+01,
     &   -0.185095184641468857E+01,
     &   -0.914734419927073827E+00,
     &   -0.466192270396250275E+00,
     &   -0.691788094137276843E+01,
     &   -0.136557687500955396E+02,
     &   -0.276696765287033770E+02,
     &   -0.829352228124176305E+00,
     &    0.293485345905240393E+02,
     &    0.214177348592993688E+02,
     &    0.154667354061095641E+01,
     &   -0.817031542280980538E+01,
     &    0.404546154543046512E+02,
     &    0.151274750732772661E+00,
     &   -0.705816051343570994E+01,
     &    0.492093584236953276E+02,
     &   -0.965562414308561578E+01,
     &    0.444083007303594499E+02,
     &    0.279310754154119545E+01,
     &   -0.401734168932827203E+02,
     &   -0.171469912772491391E+02,
     &   -0.528483498476600921E+01,
     &    0.110736598482989805E+02,
     &   -0.284435729791010488E+02,
     &   -0.259047803757834316E+01,
     &    0.479110520091133907E+01,
     &   -0.966924004553132432E+00,
     &    0.217306426286998722E+02,
     &    0.167647203435237451E+02,
     &    0.625167151808261601E-01,
     &   -0.131495931376136195E+02,
     &   -0.295771428469317421E+00,
     &    0.238832132924631901E+01,
     &    0.352808347088828933E+01,
     &    0.337070072119065589E+01,
     &   -0.122564966613143844E+01,
     &   -0.695061703153669219E+00,
     &   -0.651138619855592804E+01,
     &   -0.131693160506157998E+02,
     &   -0.277640051969325796E+02,
     &   -0.815418597580328197E+00,
     &    0.296717656637459299E+02,
     &    0.213139538563755799E+02,
     &    0.155165784441025356E+01,
     &   -0.793502678297395647E+01,
     &    0.404147777454205439E+02,
     &    0.139082396394454688E+00,
     &   -0.118546686396085494E+02,
     &    0.412909664248710868E+02,
     &    0.300165549704838286E+01,
     &    0.494867862916726864E+01,
     &    0.147551567698283836E+01,
     &   -0.115415554677031071E+02,
     &   -0.117283729778191397E+02,
     &   -0.149351548302801049E+02,
     &   -0.383158962913523737E+01,
     &   -0.255364522726712586E+02,
     &   -0.118619552407071005E+01,
     &   -0.122646171150515428E+02,
     &    0.427021259448814376E+02,
     &    0.395318149439597777E+01,
     &    0.471033697155320663E+01,
     &    0.155484875164160408E+01,
     &   -0.115688260942486227E+02,
     &   -0.117372679035852805E+02,
     &   -0.150920973434185868E+02,
     &   -0.419467298502846120E+01,
     &   -0.255557030116089159E+02,
     &   -0.127844321966643104E+01,
     &   -0.164556976332298877E+00,
     &   -0.105414999774906430E+02,
     &   -0.100680950211550275E+02,
     &   -0.113275141734910090E+02,
     &    0.307043349159978496E+00,
     &    0.767345690884052889E+01,
     &    0.933197587107730597E+00,
     &    0.734596897872190180E+00,
     &   -0.485348196106302066E+01,
     &    0.297539033174273948E+01,
     &   -0.664510465523711846E+00,
     &    0.135854795184589605E+01,
     &    0.430761509129989228E+01,
     &   -0.108542754558990517E+01,
     &    0.142678520369947375E+02,
     &   -0.127203927160016050E+01,
     &   -0.133018962534050118E+02,
     &   -0.406676304455607873E+01,
     &   -0.608791884680386475E+00,
     &    0.253572041465469455E+01,
     &    0.403924342618158683E+00,
     &    0.109389137554176993E+00
     & /
      	data(wl2(i),i=1,n)/
     &   -0.292932677632509519E+00,
     &    0.485381084813824137E+00,
     &    0.161995262383329908E+01,
     &   -0.152471811751921349E+01,
     &   -0.969957797903015795E+01,
     &   -0.151460333286576238E+00,
     &    0.642073309806972747E+00,
     &    0.106724061462130511E+02,
     &    0.774055522146687114E+01,
     &   -0.696143887357729518E+01,
     &   -0.173957620289226744E+01,
     &    0.169207039940845583E+02
     & /
      	data(b1(i),i=1,n)/
     &   -0.529891909576625419E+01,
     &   -0.808074168169177476E+01,
     &    0.118273826039503849E+02,
     &    0.137004706482499898E+02,
     &   -0.140670641184987453E+02,
     &   -0.223731733116447495E+01,
     &   -0.288277703973051729E+02,
     &   -0.146274173496111324E+02,
     &   -0.124810218863988376E+01,
     &   -0.316087463590751794E+01,
     &    0.141291351819047257E+02,
     &   -0.100819617271347326E+02
     & /
      	data b2 /0.160443175507332221E+02/
      	data(xmin(i),i=1,3)/
     &    0.108127793202777902E-01,
     &    0.659339459520386989E-04,
     &    0.366394732001052012E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.741188845941940011E+00,
     &    0.548495455842691992E+00,
     &    0.868914303199642246E+00
     & /

      ymini= 0.705362310920998326E-07
      ymaxi= 0.222462600834182650E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01

       p12=exp(-0.2d0*r(1))
       p23=exp(-0.2d0*r(2))
       p13=exp(-0.2d0*r(3))
       G(1)=(p12+p13)/2.0d0
       G(2)=p12*p13
       G(3)=p23

       G=2.0d0*(G - xmin)/(xmax - xmin) -1.0d0

       do it=1,m
		       c1(it)=0.0d0
		 do kt=1,3
			 c1(it)=c1(it)+Wi(it,kt)*G(kt)
             end do
       end do


       c1=c1+bbi
       OutLayer1= 2.0d0/(1.0d0+exp(-2.0d0*c1))-1.0d0


       do it=1,n
       	c2(it)=0.0d0
	      do kt=1,m
			c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
            end do
       end do

       c2=c2+b1
       outlayer2= 2.0d0/(1.0d0+exp(-2.0d0*c2))-1.0d0
       c3=0.0d0

       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do

       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
       end

	subroutine V2_HH(r,Vtot)
	implicit double precision (a-h,o-z)
	parameter (m=  5,n=  5)
	dimension wi(m,1),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	data((wi(i,j),j=1,1),i=1,m)/
     &   -0.817046284132321077E+01,
     &   -0.353454784018130486E+01,
     &   -0.593020544249267800E+01,
     &    0.533873874126996295E+01,
     &   -0.474354710453028616E+01
     & /
      	data(bbi(i),i=1,m)/
     &    0.891885850951094739E+01,
     &    0.286643018856337273E+01,
     &    0.195818182679643171E+01,
     &    0.237449547281921225E+01,
     &   -0.935445506371625690E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.620123664064100799E+00,
     &   -0.346565965763222017E+00,
     &    0.518867530956927503E+00,
     &   -0.119130899076464569E+01,
     &   -0.136519888537160128E+01,
     &    0.145323745227589551E+01,
     &   -0.454118981964098722E+00,
     &   -0.122285721683652193E+01,
     &    0.969842139193593855E+00,
     &    0.212957952628675740E+01,
     &    0.107706814208391610E+01,
     &    0.132158391087083515E+01,
     &   -0.301931258253550994E+00,
     &   -0.109951750579399810E+01,
     &   -0.195140418393668691E+00,
     &   -0.250800238744442039E+01,
     &   -0.881906245143301737E+00,
     &   -0.225615054218922095E+01,
     &   -0.418212586172481915E+00,
     &   -0.322093068757456635E-01,
     &   -0.365881089234975976E+01,
     &    0.767220224135331863E+00,
     &   -0.127838107993212335E+01,
     &    0.155635576111897267E+01,
     &   -0.244464523242063303E+00
     & /
      	data(wl2(i),i=1,n)/
     &    0.621443225055098414E+00,
     &   -0.266755641085243367E+01,
     &   -0.160323610954190066E+00,
     &    0.953906775210073055E+00,
     &    0.360371942303164072E+01
     & /
      	data(b1(i),i=1,n)/
     &    0.239370886119220083E+01,
     &   -0.214316436464388316E+01,
     &    0.211297757684635296E+00,
     &   -0.794681031243798297E+00,
     &   -0.138919716279077754E+01
     & /
      	data b2 / 0.129248499042672726E+01/
      	data xmin/
     &    0.492916787604621501E-01
     & /
      	data xmax /
     &    0.941764533584248720E+00
     & /
      ymini=-0.174568956885249982E+00
      ymaxi= 0.229739059836063908E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01

	 if(r.lt.30.0)then
       p=exp(-0.1d0*r)
       elseif(r.ge.30.0)then
	  p=exp(-0.1d0*30.0)
	endif	

	G=2.0d0*(p - xmin)/(xmax - xmin) -1.0d0
       do it=1,m
		       c1(it)=0.d0
		       do kt=1,1
       c1(it)=c1(it)+Wi(it,kt)*G
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0d0/(1.0d0+exp(-2.0d0*c1))-1.0d0
       do it=1,n
       		c2(it)=0.d0
	       	do kt=1,m
       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0d0/(1.0d0+exp(-2.0d0*c2))+ymino
       c3=0.0d0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
       if(r.lt.0.6)then
            vtot=6.02347985*dexp(-4.4126257*r)-0.196860
        endif
      end


      subroutine V2_LiH(r,Vtot)
	implicit double precision (a-h,o-z)
	parameter (m=  5,n=  5)
	dimension wi(m,1),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	data((wi(i,j),j=1,1),i=1,m)/
     &    0.619891038120547222E+01,
     &    0.110894135280946537E+01,
     &   -0.470247332667846329E+01,
     &    0.597373131595848772E+01,
     &    0.647509845668187811E+01
     & /
      	data(bbi(i),i=1,m)/
     &   -0.718703855319038531E+01,
     &   -0.967620227057712445E+00,
     &    0.911285485308843679E+00,
     &    0.140424083775741892E+01,
     &    0.750155417602716756E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.130164288965598529E+01,
     &   -0.122734808886005653E+01,
     &   -0.786501521837533635E+00,
     &    0.222614069766592815E+00,
     &    0.751567830230107647E+00,
     &   -0.343274760814511870E+01,
     &    0.107123868778133469E+01,
     &    0.483079532397419131E+00,
     &   -0.162028088956584515E+01,
     &    0.273122864062671389E+00,
     &    0.372505624069403074E+00,
     &    0.411403190779249073E+01,
     &    0.840059736003400337E+00,
     &    0.741463814513627750E+00,
     &   -0.991239305378488256E+00,
     &    0.116948989696184324E+01,
     &    0.557708322017598124E+00,
     &   -0.445271631318039651E+00,
     &    0.588411601173929322E+00,
     &    0.383631110050654603E-01,
     &    0.118414590949928034E+01,
     &    0.204766419453463744E+01,
     &   -0.273207528248838205E+00,
     &    0.131692418115769350E+01,
     &   -0.672378293513811509E+00
     & /
      	data(wl2(i),i=1,n)/
     &    0.193540018656617674E+01,
     &   -0.759359762571649610E+00,
     &    0.449107919559729130E+01,
     &   -0.377148415168766099E-01,
     &   -0.494650383276537597E+00
     & /
      	data(b1(i),i=1,n)/
     &    0.217962750140244665E+01,
     &    0.218812130676543787E+00,
     &    0.274279550240611902E+00,
     &    0.836408041995206131E+00,
     &    0.103566743431856811E+01
     & /
      	data b2 / 0.228617924199038569E+01/
      	data xmin/
     &    0.403566132720311332E-01
     & /
      	data xmax /
     &    0.878095430920561304E+00
     & /
      ymini=-0.924786045901591081E-01
      ymaxi= 0.276310401475409861E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01

       if(r.lt.30.0)then
       p=exp(-0.1d0*r)
       elseif(r.ge.30.0)then
	  p=exp(-0.1d0*30.0)
	endif	

       G=2.0d0*(p - xmin)/(xmax - xmin) -1.0d0
       do it=1,m
		       c1(it)=0.d0
		       do kt=1,1
       c1(it)=c1(it)+Wi(it,kt)*G
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0d0/(1.0d0+exp(-2.0d0*c1))-1.0d0
       do it=1,n
       		c2(it)=0.d0
	       	do kt=1,m
       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0d0/(1.0d0+exp(-2.0d0*c2))+ymino
       c3=0.0d0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
       if(r.lt.1.3)then
            vtot=5.020428778134964*dexp(-1.93642128*r)-0.12870412
        endif
      end
      
       function swifun(r,rd,rw)
       implicit double precision (a-h,o-z)
       swifun=1.0-0.5*(1.0+tanh((r-rd)/rw))
       return
       end



      subroutine V3_EXTR(r,Vtot)
c	r(1),r(3)--LiH
c	r(2)--H2
	implicit double precision (a-h,o-z)
	parameter (m= 11,n= 12)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)

	data((wi(i,j),j=1,3),i=1,m)/
     &   -0.178103503798830132E+01,
     &   -0.357317102474644033E+01,
     &   -0.124582768689533684E-01,
     &    0.489141173161697418E+00,
     &   -0.153298208794290319E+00,
     &    0.200234242934167384E+01,
     &    0.227270955510072303E+01,
     &   -0.420041119484184544E+00,
     &   -0.726054968105915854E+00,
     &    0.392453838158474966E+01,
     &   -0.339598505088493985E+01,
     &   -0.110125674235654003E+01,
     &    0.384713670994198820E+01,
     &    0.252018206698590652E+00,
     &   -0.166581784753166179E+00,
     &   -0.114423122973187619E+01,
     &    0.300401004372708380E+01,
     &   -0.915403027382270751E+00,
     &   -0.807667112815372512E+00,
     &    0.225754185619389247E+01,
     &   -0.224369213725559158E+01,
     &    0.166546216938075742E+01,
     &    0.722604901427221780E+00,
     &   -0.634955486106814487E-01,
     &   -0.348230315849195671E+00,
     &    0.223920156616580934E+01,
     &   -0.388665162249764062E+01,
     &    0.106824661402968557E+01,
     &   -0.140908376650196066E+01,
     &   -0.255300580953379397E+01,
     &   -0.234465457641836750E+01,
     &   -0.135900277925083590E+01,
     &   -0.471449735280814325E-01
     & /
      	data(bbi(i),i=1,m)/
     &    0.320117980512571831E+01,
     &   -0.213446131122580818E+01,
     &   -0.140744062183953744E+01,
     &   -0.181902138769276100E+01,
     &   -0.237710376220560349E+01,
     &   -0.190422022265876484E+00,
     &   -0.234802272256999872E+00,
     &   -0.793793646249577184E-01,
     &    0.199588988056363026E+01,
     &    0.211477285057283515E+01,
     &   -0.193543925942516326E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.593353251607279364E+00,
     &   -0.378506442789863007E+00,
     &   -0.460106453047935016E+00,
     &   -0.102963578430870409E+00,
     &   -0.515553624957554191E+00,
     &    0.944512625789726834E+00,
     &   -0.779113718532463362E+00,
     &    0.736474772194532168E+00,
     &   -0.589906470177468806E-01,
     &    0.818908265295581361E+00,
     &   -0.865868023444375745E+00,
     &   -0.193365402614716658E+00,
     &   -0.211879144433372468E+00,
     &    0.909646056792430158E+00,
     &    0.111512808878189396E+01,
     &    0.117154166650002489E+01,
     &   -0.225964208300433178E+01,
     &   -0.827882115751218950E-01,
     &    0.189925158970982999E+00,
     &   -0.789021037339692199E+00,
     &    0.329050452588741216E+00,
     &    0.134188462906194839E+01,
     &    0.755569362424272417E+00,
     &    0.485699562620448111E+00,
     &   -0.632315202100008134E+00,
     &    0.237391427456177147E-01,
     &    0.435947795422687523E+00,
     &    0.415963098796952535E+00,
     &   -0.537575159296694638E+00,
     &    0.578164225907492724E+00,
     &    0.122094854114367601E+01,
     &    0.803233436644533394E+00,
     &   -0.765665009336704783E+00,
     &    0.780041859991933290E-01,
     &    0.806165112401590389E+00,
     &   -0.531508474848380930E+00,
     &    0.688810525584142574E-01,
     &    0.251141392496622862E+01,
     &   -0.179475072525174806E+01,
     &    0.433889808640946617E+00,
     &    0.260721036637168058E+00,
     &   -0.139302445829069232E+01,
     &    0.932974277066137336E+00,
     &   -0.152790160047776430E+00,
     &    0.540863655593470494E+00,
     &    0.327205099897590612E+01,
     &   -0.100821980063025274E+01,
     &    0.133072517737808527E+01,
     &   -0.271772111429359808E+00,
     &    0.122249224838055670E+01,
     &   -0.659429438911342092E+00,
     &   -0.620709028472177793E+00,
     &    0.812702623588903439E+00,
     &   -0.139739301978376407E+01,
     &    0.398425383006875300E+00,
     &   -0.334511672798696869E+00,
     &   -0.137299178884886630E+00,
     &    0.206813310205175460E+01,
     &   -0.140670751241237846E+01,
     &   -0.138804639489044357E+01,
     &    0.113316125301702653E+01,
     &   -0.547735266953809696E+00,
     &   -0.590915811117394885E+00,
     &    0.381838246409972881E+00,
     &   -0.106750318011935175E+01,
     &   -0.722592120267193883E+00,
     &   -0.156628743907143053E+01,
     &   -0.515126135264261431E+00,
     &   -0.214780512109418398E+00,
     &   -0.102108194544028463E+01,
     &   -0.109793455873961099E+01,
     &    0.118879877245289167E+01,
     &   -0.442169308186646903E+00,
     &   -0.638839920700045139E+00,
     &   -0.109842806582307562E+01,
     &   -0.555940124208033515E+00,
     &    0.542370052232148070E+00,
     &    0.263942743428654147E+00,
     &   -0.122501759611431149E+01,
     &    0.112230135991171681E+00,
     &    0.239820659030021011E+01,
     &    0.118606530887521777E+01,
     &   -0.113185744699326918E+01,
     &   -0.139896649218584224E+01,
     &    0.657829132618575341E+00,
     &   -0.804716887701396821E+00,
     &    0.194516538053663174E+00,
     &    0.307490992723651324E+00,
     &    0.232098549995656156E+00,
     &    0.752801262328039567E+00,
     &    0.174565786828059277E+01,
     &    0.701399163660980207E+00,
     &    0.254890000535959294E+01,
     &   -0.211758039815053012E+01,
     &   -0.521951729398725139E+00,
     &    0.104830345148542337E+00,
     &   -0.168880918233470889E+01,
     &   -0.213109622425355555E+00,
     &    0.212577291889179815E-01,
     &    0.426521838844864609E+00,
     &    0.242729673083147995E+00,
     &   -0.591190590870283472E+00,
     &    0.236244638390651041E+01,
     &    0.118069535423245964E+01,
     &   -0.375245595109419683E+00,
     &   -0.149480818513723479E+01,
     &   -0.497659913506947493E+00,
     &   -0.782159817471708041E+00,
     &   -0.410875776575680529E+00,
     &   -0.517544140361232419E+00,
     &    0.103852212589334703E+01,
     &    0.682456468419208817E+00,
     &   -0.885691779175720728E+00,
     &   -0.486530547519659906E-01,
     &    0.179260266174133931E+01,
     &    0.646401540939488206E+00,
     &   -0.408751450271547412E+00,
     &    0.905994234647478219E-01,
     &   -0.126276983764029138E+01,
     &    0.669226745710546078E+00,
     &    0.596703201946801667E-01,
     &    0.130968413269779438E+01,
     &    0.113354070943281493E+01,
     &    0.122420175045967894E+01,
     &   -0.400425012287079329E+00,
     &    0.457295673831916438E+00,
     &    0.140850742613382179E+00,
     &    0.534632795717540424E-01,
     &    0.814606690200285533E+00,
     &    0.352656881277880474E+00,
     &    0.847309016978300189E+00,
     &   -0.210442015510845071E+00
     & /
      	data(wl2(i),i=1,n)/
     &    0.515273090541079726E+00,
     &    0.116703574488403250E+01,
     &   -0.708412772995578255E+00,
     &   -0.282633156776656280E+01,
     &    0.238385455835271642E+01,
     &    0.227520567204691382E+01,
     &   -0.507295980477348696E+00,
     &    0.132363875916423224E+01,
     &    0.129378653896445961E+01,
     &   -0.110040357408616107E+01,
     &    0.160916962427849297E+01,
     &    0.171797985973348855E+01
     & /
      	data(b1(i),i=1,n)/
     &    0.144462984437835185E+01,
     &    0.223753321982502840E+01,
     &   -0.682461166429268351E+00,
     &   -0.510856735275754370E+00,
     &    0.221792534785795192E+00,
     &   -0.319891391561648641E+00,
     &   -0.280406746508579441E+00,
     &    0.564858023277736709E+00,
     &    0.158122047022609680E+01,
     &    0.204438993921180856E+01,
     &   -0.101030092258569004E+01,
     &    0.208203242425271418E+01
     & /

      	data b2 / 0.852135909586895890E+00/

      	data(xmin(i),i=1,3)/
     &    0.159227254658019721E-01,
     &    0.253294854758376049E-03,
     &    0.179529649395028489E-01
     & /

      	data(xmax(i),i=1,3)/
     &    0.722104225951316181E+00,
     &    0.521430622451509840E+00,
     &    0.865887748059204987E+00
     & /

      ymini= 0.204918013295766008E-07
      ymaxi= 0.175428278688725004E-02
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01

       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))

       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23

       G=2.0*(G - xmin)/(xmax - xmin) -1.0

       do it=1,m
		c1(it)=0
	      do kt=1,3
		   c1(it)=c1(it)+Wi(it,kt)*G(kt)
       	end do
       end do

       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0

       do it=1,n
       	c2(it)=0
	       do kt=1,m
	        c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       	end do
       end do

       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0

       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do

       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
       end
