*********************************************************************
*                                                                   *
*     SH2 SURFACE EVALUATION ROUTINES FOR THE GROUND STATE 1A'      *
*     r(1)--rSHa(a.u.)  r(2)--rHH(a.u.) r(3)--rSHb(a.u.)            *
*     V: Energy value in hartree                                    *
*     Scientific Reports 2015, 5, 14594                             *
*                                                                   *
*********************************************************************   

      subroutine SH2_PES(r,V)
c     r(1),r(3)--SH
c     r(2)--H2
      implicit double precision (a-h,o-z)
      dimension r(3)
      if (r(1)>r(3))then
        rSHmin=r(3)
      else
        rSHmin=r(1)
      endif
      rSHmin1=3.91
      rSHmin2=4.51
      rHH1=2.41
      rHH2=3.01
      rHH=r(2)
      if ((rSHmin<=rSHmin1).or.(rHH<=rHH1))then
        call SH2_important(r,V)

      elseif((rSHmin>=rSHmin2).and.(rHH>=rHH2))then
        call SH2_other_part(r,V)

        elseif ((rSHmin>rSHmin1).and.(rHH>rHH1.and.rHH<rHH2))then
        call SH2_important(r,V1)
        call SH2_other_part(r,V2)
        rw=0.03
        rd=2.6
        V=V1*swifun(rHH,rd,rw)+V2*(1.0-swifun(rHH,rd,rw))

        elseif ((rHH>rHH2).and.(rSHmin>rSHmin1.and.rSHmin<rSHmin2))then
        call SH2_important(r,V1)
        call SH2_other_part(r,V2)
        rw=0.03
        rd=4.1
        V=V1*swifun(rSHmin,rd,rw)+V2*(1.0-swifun(rSHmin,rd,rw))
      endif

      end






      subroutine SH2_important(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
      	dimension r(3)
      call SH2PES_i_1(r,Vtot_1)
      call SH2PES_i_2(r,Vtot_2)
c      call SH2PES_i_3(r,Vtot_3)
      call SH2PES_i_4(r,Vtot_4)
      call SH2PES_i_5(r,Vtot_5)
      call SH2PES_i_6(r,Vtot_6)
      call SH2PES_i_7(r,Vtot_7)
c      call SH2PES_i_8(r,Vtot_8)
      call SH2PES_i_9(r,Vtot_9)
      Vtot=(Vtot_1+Vtot_2+Vtot_4+Vtot_5+
     & Vtot_6+Vtot_7+Vtot_9)/7.0
      end



       subroutine SH2PES_i_1(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.878025162228725087E+01,
     &   -0.475621550729550790E+01,
     &    0.117875471699475942E+01,
     &   -0.687689856183426240E+01,
     &    0.404395219000639905E+01,
     &   -0.452766524687420249E-01,
     &   -0.604440578506164705E+01,
     &    0.613748416193611135E+01,
     &   -0.511615691462451672E+00,
     &    0.957136817183154065E+01,
     &   -0.413339497978352988E+01,
     &   -0.905522733523158507E+01,
     &   -0.455313620837391020E+00,
     &   -0.154748496419949744E+01,
     &   -0.101826226404989770E+00,
     &   -0.345125355146788948E+01,
     &    0.158096908312059048E+01,
     &    0.275458821085564942E+01,
     &   -0.669352630596709131E+00,
     &   -0.108311263641657440E+01,
     &   -0.936692446726320460E+00,
     &   -0.144053730331805685E+00,
     &    0.642634026901036520E-01,
     &    0.149870655258130014E+02,
     &    0.161884638432232353E+01,
     &   -0.245974856970785538E+01,
     &   -0.125100097193894189E+01,
     &   -0.378190257192337786E+00,
     &   -0.759977178482491023E-01,
     &   -0.226567083598624208E+01,
     &   -0.498312609498964321E+01,
     &   -0.272152688383063435E+01,
     &    0.101999656223477757E+02,
     &   -0.334845620468118110E+00,
     &    0.123442328239295374E+01,
     &    0.207547436321846579E+01,
     &   -0.129630596326314080E+02,
     &    0.114594572783452673E+02,
     &    0.139922699485592528E+01,
     &   -0.132344817106398671E+01,
     &    0.302752849925250223E+01,
     &   -0.328645282685954276E+01,
     &   -0.313750645121627481E+00,
     &   -0.208075858862758611E+01,
     &   -0.331933770994363164E+00
     & /
      	data(bbi(i),i=1,m)/
     &   -0.525737539123268860E+01,
     &    0.518498364407953360E+01,
     &    0.382075686771055478E+01,
     &   -0.752039712848536901E+01,
     &    0.103646022022786277E+00,
     &   -0.584644576817939465E+00,
     &   -0.146592535394446921E+01,
     &   -0.137145050222395737E+01,
     &   -0.263233555257102614E+01,
     &    0.123245616889118303E+01,
     &    0.681766105448463122E+01,
     &   -0.140071501506293195E+01,
     &    0.653677744922136661E+01,
     &   -0.583279386801876187E+00,
     &   -0.195347027671264040E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.282191300321320870E+01,
     &   -0.392291956297646749E+02,
     &    0.155829982783760745E+01,
     &   -0.128959674980068173E+01,
     &    0.716158135799889961E+00,
     &   -0.334636534104668515E+01,
     &   -0.143664099261779281E+02,
     &   -0.824868494404394026E+00,
     &    0.150316139264293511E+02,
     &    0.258082330118453340E+01,
     &    0.147363051808644796E+01,
     &    0.222478350039945116E+01,
     &    0.245905256730653249E+00,
     &   -0.261331968787899861E-01,
     &    0.861392595661967775E+01,
     &   -0.112874233166429541E+02,
     &    0.331680720439340337E+01,
     &    0.564854982437563824E+00,
     &   -0.362293354855776473E+01,
     &   -0.870868464393985597E+01,
     &    0.347038050711607626E+01,
     &   -0.375455930002914551E+00,
     &    0.200261306562494773E+00,
     &    0.660890082290766934E+01,
     &    0.239693712160542161E+01,
     &    0.413284067954664547E+01,
     &    0.805667470280960085E+00,
     &   -0.111364844757960455E+02,
     &   -0.373152304725382633E+01,
     &    0.578449931551860175E+01,
     &   -0.848693547987387720E+00,
     &   -0.536948979583592845E+01,
     &   -0.948504739336268110E+00,
     &    0.653106098551289316E-01,
     &   -0.171990245385046725E+01,
     &   -0.216248449150318933E+00,
     &    0.232428588958001514E+01,
     &   -0.204768138864046767E+00,
     &    0.425079940008070256E+01,
     &    0.310290256501359218E+00,
     &   -0.101461454167461049E+02,
     &    0.204272404844442451E+00,
     &   -0.190765909256272764E+00,
     &    0.468796678384237053E+00,
     &   -0.208234385158093138E+01,
     &    0.250310975834469318E+00,
     &    0.262811891202032832E+01,
     &    0.110570802314517699E+00,
     &    0.529837650950581884E+00,
     &   -0.352396532993817957E+00,
     &   -0.200091297838411869E+00,
     &    0.176989643241763410E+02,
     &   -0.402325879880690573E-01,
     &   -0.165463294702321519E+02,
     &   -0.509857986389566920E+00,
     &   -0.948802481804180475E+00,
     &   -0.310657916130704925E+00,
     &    0.712285347136621616E+00,
     &    0.520824866696224742E+00,
     &   -0.146866471988861278E+02,
     &   -0.134825676241894565E+01,
     &   -0.658978404923178207E+01,
     &   -0.778448635100598585E+00,
     &    0.322271726620860288E+00,
     &   -0.568010507371841666E+00,
     &    0.864499560416609025E+00,
     &   -0.126132203112696728E+01,
     &   -0.130681804061597961E+00,
     &    0.378866752032410270E+01,
     &    0.256593675168203472E+00,
     &    0.203748118351227658E+01,
     &    0.545645672470504370E-01,
     &   -0.298627228144438761E+00,
     &    0.298154083241233603E+00,
     &    0.139965371135740213E+01,
     &    0.110024608543204696E+02,
     &   -0.514468230024291895E+01,
     &   -0.647724871768696642E+00,
     &    0.324137661696250001E+01,
     &    0.848662359886996143E+01,
     &   -0.346606667483354158E+01,
     &   -0.187406074782567517E+00,
     &   -0.179060800225413652E+00,
     &   -0.421281737507424747E+01,
     &   -0.248371110136897411E+01,
     &   -0.552602494857342386E+01,
     &   -0.803138358379204442E+00,
     &    0.107897778215757807E+02,
     &    0.358611067874750766E+01,
     &   -0.534094385011096318E+01,
     &   -0.115174993242268030E+03,
     &    0.574589770385595671E+02,
     &    0.232059374776081064E+02,
     &    0.867674242209819724E+01,
     &   -0.653144167145511858E+02,
     &    0.310803449812753847E+02,
     &   -0.127938005091126428E+03,
     &   -0.249356611968893986E+02,
     &    0.596525554414681096E+02,
     &    0.415802835046483565E+02,
     &   -0.156889886546373933E+02,
     &    0.262308861834999405E+02,
     &   -0.565611317746144451E+02,
     &   -0.668256543652388189E+02,
     &    0.660252671729576122E+02,
     &   -0.406960073786084342E+00,
     &   -0.377415847832974283E+01,
     &    0.240889319434870993E-02,
     &   -0.530676846725890217E+00,
     &    0.388211666101008102E+00,
     &    0.476465787783688144E+00,
     &   -0.176036335701819269E+02,
     &    0.426442560046843624E-01,
     &    0.169687714310611817E+02,
     &    0.565998308786183291E+00,
     &    0.106712989849184825E+01,
     &    0.327818192132576069E+00,
     &   -0.730111044408092935E+00,
     &   -0.499760160425404554E+00,
     &    0.140249307555855349E+02,
     &    0.900020005004253165E+00,
     &   -0.947584133412343599E+00,
     &    0.938871602609070877E+00,
     &    0.840348350786182391E-01,
     &    0.182128712308763729E+01,
     &    0.218640474014200753E+00,
     &   -0.231416397728391843E+01,
     &    0.204806268823051502E+00,
     &   -0.421182709095889152E+01,
     &   -0.315916299464422345E+00,
     &    0.117939984942904239E+02,
     &   -0.214228564737289517E+00,
     &    0.198672736777694009E+00,
     &   -0.116841332145298193E+01,
     &    0.207275411457130732E+01,
     &    0.462526196039558446E+01,
     &    0.112943145642886279E+03,
     &    0.243826381810415738E+01,
     &   -0.114562650405994293E+01,
     &   -0.254450946470981265E+00,
     &   -0.635861324802379224E+00,
     &    0.713793314158736258E+01,
     &   -0.108282546921924253E+00,
     &   -0.103616973017731731E+02,
     &   -0.304513040261499990E+01,
     &   -0.700011426264129000E+01,
     &   -0.343642042724885854E+01,
     &   -0.436059704542033744E+00,
     &    0.574312238110459949E+00,
     &   -0.575726582287456878E+01,
     &    0.161572853534546490E+01,
     &    0.474637813388427929E+02,
     &   -0.141962661147425084E+02,
     &    0.386041097086746419E+02,
     &   -0.523438672440550690E+01,
     &   -0.362632374694317905E+01,
     &   -0.400405402812266598E+01,
     &   -0.356991125233894535E+00,
     &   -0.841649306097351158E+01,
     &   -0.262046715855092316E+00,
     &   -0.982092204933989521E+01,
     &   -0.316204566994394420E+00,
     &    0.533568835498551266E+02,
     &   -0.227942484215247498E+01,
     &    0.138729946164214262E+02,
     &    0.337650925391224810E+01,
     &   -0.124782662302355316E+02,
     &    0.337211056561002609E+01,
     &   -0.198689383154268784E+01,
     &   -0.383919003195140496E+00,
     &    0.105098270978825625E+01,
     &    0.177654432995421061E+02,
     &   -0.102540083645649704E+01,
     &   -0.226971998595775304E+01,
     &    0.932035248764534074E+01,
     &   -0.488577558710119941E+01,
     &    0.812860862036072618E+01,
     &   -0.386217029617445459E-01,
     &   -0.102114802366057256E+01,
     &   -0.212180883736114154E+02,
     &    0.202295689111960830E+00,
     &    0.384087744261435704E+01,
     &   -0.106449225354780658E+00,
     &    0.387183339078522801E-01,
     &    0.196479903007806850E+00,
     &   -0.215439941274390812E+01,
     &   -0.466106599488084683E+01,
     &    0.193263912955805806E+00,
     &   -0.306718431916840961E+01,
     &   -0.248646430064954405E+00,
     &    0.104396763518610003E+01,
     &   -0.842331343712921066E+00,
     &    0.300713623633343474E+00,
     &   -0.381502970656854179E+00,
     &    0.209662346096571195E+01,
     &   -0.694223391638390286E+01,
     &   -0.248829922106930397E+02,
     &    0.127839752521364480E+00,
     &    0.883038011381828553E-01,
     &   -0.266029064295138484E+01,
     &    0.317665269869539602E+01,
     &    0.490327132385939368E+01,
     &   -0.367916522520192246E+00,
     &    0.240328007089740225E+01,
     &    0.214687397987399020E+01,
     &   -0.320918952326706775E+01,
     &    0.247648541153776147E+01,
     &   -0.356654568146614226E+00,
     &   -0.243173201946833561E+01,
     &   -0.288813343380003884E+01,
     &   -0.210298922667838362E+01,
     &   -0.580793923992829253E+01,
     &    0.159054360138874245E+02,
     &   -0.411869539049531568E+02,
     &    0.685479795903809563E+01,
     &   -0.191391744605962622E+01,
     &   -0.299580345918533819E+01,
     &   -0.131876668088017041E+00,
     &    0.962583885270972672E+01,
     &   -0.917412572192540665E+01,
     &    0.498083068675023100E+01,
     &   -0.615529706945207256E+01,
     &   -0.553995354054435580E+02,
     &    0.148879139985012676E+01,
     &   -0.375741539837975980E+01
     & /
      	data(wl2(i),i=1,n)/
     &   -0.929375381620348856E-01,
     &    0.272359107877631779E+02,
     &    0.235821060781612992E+02,
     &    0.135857853733316006E+03,
     &   -0.126012748439650917E+02,
     &    0.114357534352699872E+03,
     &   -0.201854176312057731E+02,
     &    0.326825228478320042E+02,
     &    0.234801915064036599E+02,
     &   -0.106877643441406960E+02,
     &   -0.989630906584909980E+02,
     &   -0.734550814124812064E+02,
     &   -0.865276128829004065E+00,
     &    0.633339204512138321E-01,
     &   -0.310781199436986988E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.393246434511711200E+02,
     &    0.262446079265926091E+01,
     &    0.222015078733553750E+02,
     &   -0.174099123852994886E+02,
     &    0.111571609110558363E+02,
     &    0.170860020972477455E+01,
     &   -0.846810142514220132E+02,
     &    0.175751169873396726E+02,
     &   -0.180952776131474415E+02,
     &   -0.115964856306121675E+03,
     &   -0.481749918461418929E+02,
     &    0.312639972618410056E+01,
     &   -0.135729023245969689E+02,
     &    0.278787027886336389E+02,
     &    0.103013647159289263E+02
     & /
      	data b2 / 0.692661212270808875E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end


       subroutine SH2PES_i_2(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &   -0.651677595607442495E+01,
     &    0.212475991574467837E+01,
     &   -0.155541673110740009E+01,
     &    0.182579890864585281E+01,
     &    0.235570164160015105E+01,
     &   -0.588069702701835340E+01,
     &   -0.429681824158266307E-01,
     &    0.162248922972187237E+00,
     &    0.135760904908263691E+01,
     &   -0.147248576537564606E+02,
     &    0.132121041173638059E+02,
     &    0.128885123585172146E+01,
     &    0.125806583199641497E+00,
     &   -0.424100547613509293E+00,
     &    0.335102550081342532E+01,
     &   -0.105346307710692830E+02,
     &    0.611414263395706925E+01,
     &   -0.764316039931443592E+00,
     &   -0.865402859570299476E+01,
     &    0.562682195149085196E+01,
     &    0.593949269338948871E+00,
     &    0.319523669282782263E+01,
     &    0.558103946912693882E-01,
     &    0.384599381540657981E+00,
     &   -0.436427120623144538E+00,
     &   -0.143753785615745233E+01,
     &    0.130266426679912772E+01,
     &   -0.607988824245182746E+00,
     &    0.229859895395884761E+01,
     &   -0.439569729539319942E+00,
     &    0.177429009562687506E+00,
     &   -0.772550233309353906E+00,
     &    0.421420781924024634E+01,
     &   -0.439254648624890986E+01,
     &    0.714882480209672533E+01,
     &   -0.783355266257995542E+01,
     &   -0.260068405408987768E+01,
     &    0.517730164384397784E+00,
     &    0.303903061390330764E+01,
     &    0.144829264570535465E+01,
     &   -0.632188392012460287E+01,
     &    0.930322784662773183E+00,
     &    0.601142632893369666E+00,
     &   -0.235563943026393918E+01,
     &   -0.884762989490951446E+00
     & /
      	data(bbi(i),i=1,m)/
     &    0.601078286090345237E+01,
     &   -0.455049031660612258E+01,
     &   -0.882210610173428611E+00,
     &    0.750315746545136175E+01,
     &   -0.230856767913742295E+00,
     &    0.653881564242947455E+01,
     &    0.308257514332568361E+01,
     &   -0.580776353824451808E+00,
     &    0.821599734385403013E+00,
     &    0.900160227074129349E+00,
     &   -0.160627435920595474E+01,
     &   -0.104506092149660779E+01,
     &   -0.339540024349997083E+00,
     &   -0.403082564622122863E+01,
     &   -0.318893660122252420E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.825279162861536797E+01,
     &   -0.501412464959613846E+01,
     &    0.409729968306796124E+02,
     &    0.358543816818928662E-01,
     &   -0.115125283608831008E+02,
     &   -0.998756273687399720E+00,
     &   -0.791927333762233565E+00,
     &   -0.777719298348536925E+00,
     &    0.397311036706163589E+01,
     &   -0.903798869122663828E+00,
     &    0.172047605200460052E+01,
     &    0.412990502832846010E-01,
     &    0.826812438216519618E+00,
     &    0.282166057858385277E+00,
     &    0.697546834079770584E+01,
     &    0.471970022080005935E+00,
     &   -0.469627643828975572E+01,
     &    0.295196822546312188E+00,
     &    0.249178086128992754E+00,
     &    0.309047943210183862E+00,
     &    0.100701262148304305E+01,
     &    0.535347225533122972E+00,
     &   -0.398939559916617281E+00,
     &    0.741018473207877393E+00,
     &    0.154098264056182588E+01,
     &   -0.136543128178244183E+00,
     &    0.185943732012093632E+00,
     &    0.307201251891930371E+00,
     &    0.274222431865524030E+00,
     &   -0.121284463211344686E+02,
     &    0.263401566015087152E+01,
     &    0.324805707449337167E+01,
     &    0.167223213272152127E+01,
     &    0.220990717004820370E+00,
     &    0.262563438420873208E+00,
     &   -0.271944465458030471E+00,
     &    0.347498582293886971E+00,
     &    0.524834167626090295E-01,
     &   -0.700125608656264720E+00,
     &    0.226752547848991966E-01,
     &   -0.879482227537855432E+00,
     &    0.248278030114754716E+00,
     &   -0.386191267215771489E-01,
     &    0.227988197275425047E+00,
     &   -0.114158405831956955E+02,
     &   -0.698516770924014807E+01,
     &   -0.543028946896040736E+02,
     &    0.171290508757197157E+01,
     &   -0.686435391747055768E+01,
     &   -0.218021999713575765E+01,
     &    0.934059638053743413E+01,
     &   -0.148109259858876602E+00,
     &    0.177569002078443194E+01,
     &   -0.158209260901937943E+01,
     &    0.449947587636518875E+00,
     &   -0.216101411045963754E+00,
     &   -0.397419761676462047E+01,
     &   -0.563988230581799921E+00,
     &    0.156326120122135936E+01,
     &    0.171182247974155146E+02,
     &    0.379899212617316684E+00,
     &   -0.131935152475522841E+02,
     &    0.187606597413669168E+00,
     &    0.439421787409870146E+00,
     &    0.145672943932813026E+01,
     &    0.149013659893787842E+00,
     &    0.161548085919152817E+00,
     &    0.141393290190390663E-01,
     &    0.298737532607262934E+00,
     &   -0.109126214009754308E+00,
     &    0.105709267258313838E+00,
     &    0.671979754620341541E+00,
     &   -0.851753536153037477E-01,
     &    0.508393231040041763E-04,
     &   -0.774883658117019536E+01,
     &   -0.174996059298033413E+01,
     &    0.286098872617677014E+01,
     &   -0.138427969896839698E+00,
     &   -0.469739116656141986E+00,
     &   -0.554382588132011689E+00,
     &   -0.162591130001485373E+01,
     &   -0.281417036149388622E+00,
     &    0.621206182392883832E+00,
     &    0.138170195294109815E+00,
     &   -0.145886454182264647E+01,
     &   -0.356189171716248310E+00,
     &   -0.934096836369447736E+00,
     &    0.148258086241116506E-01,
     &    0.115720040565020707E+00,
     &    0.243053197919812263E+02,
     &   -0.226099322646085094E+00,
     &   -0.377454610480439667E+01,
     &   -0.522845880065251012E+00,
     &    0.484790111127553602E+00,
     &    0.682324906145474808E+00,
     &    0.851402909260793206E+00,
     &    0.401365069383381901E+00,
     &   -0.610852264396852029E+00,
     &   -0.278788045723442179E+00,
     &    0.124519469606928168E+01,
     &   -0.256678758214854696E+00,
     &    0.780149019993726434E+00,
     &    0.357930822711320484E+00,
     &   -0.810132634883803937E-01,
     &   -0.422899775303685388E+02,
     &   -0.693940113739842079E+01,
     &   -0.530941245741706922E+02,
     &    0.171955783287596575E+01,
     &   -0.684600560506593769E+01,
     &   -0.219378407065410697E+01,
     &    0.910292258980454960E+01,
     &   -0.171434245779746058E+00,
     &    0.174579761496825658E+01,
     &   -0.157291928226218602E+01,
     &    0.419324218736719823E+00,
     &   -0.191918689206674931E+00,
     &   -0.403426232413239561E+01,
     &   -0.593036895903010230E+00,
     &    0.155316678890851767E+01,
     &    0.172087422327714279E+02,
     &   -0.363548352753845236E+02,
     &    0.529954076892613983E+02,
     &    0.849110285240167997E+02,
     &    0.405187447971119425E+02,
     &    0.156252677299648912E+02,
     &    0.170950470746555254E+03,
     &   -0.102064169166349032E+03,
     &   -0.399441216195447879E+02,
     &   -0.113115326283894468E+02,
     &    0.246847928561409944E+02,
     &    0.119914994465256219E+01,
     &    0.418685183712910742E+02,
     &   -0.153975569233545562E+01,
     &   -0.359638567584774123E+02,
     &    0.715143287707353181E+02,
     &   -0.387204455740417597E+01,
     &   -0.233736144123429774E+02,
     &    0.389123216100007863E+01,
     &    0.404737368505804795E+01,
     &   -0.724882584680801845E+01,
     &   -0.117011423163644217E+02,
     &   -0.687921231779812636E+01,
     &   -0.278210844148137371E+01,
     &   -0.474205219715042237E+01,
     &   -0.325299451386301453E+01,
     &    0.709687144816715865E+01,
     &    0.356524706933891133E+01,
     &    0.853230375761345083E+00,
     &   -0.721748532306612400E+00,
     &   -0.173259192419217563E+02,
     &   -0.207060065615822309E+01,
     &    0.100642623802371145E+01,
     &   -0.457401230168687345E+01,
     &    0.756574082544056781E+00,
     &    0.118131293248547431E+01,
     &   -0.157730012700201372E+01,
     &   -0.345659789969561815E+00,
     &    0.107658332139063215E+00,
     &   -0.127653454678039968E+01,
     &   -0.149539087253501379E+01,
     &   -0.677060446427410922E+00,
     &    0.103366560457282008E+01,
     &   -0.137694749706677694E+00,
     &    0.396724518701843054E+00,
     &   -0.283323197831288773E+02,
     &   -0.171705192727775985E+00,
     &   -0.402862595811965640E+01,
     &   -0.501483311815444477E+00,
     &   -0.248897934766905610E+00,
     &   -0.147296109285029841E+00,
     &    0.263379772885662777E+00,
     &   -0.423343720151052760E+00,
     &   -0.370100493178569887E-02,
     &   -0.273539322363535287E+00,
     &   -0.413184045820707058E+00,
     &    0.584062311196307318E-01,
     &   -0.183493318671000910E+00,
     &   -0.215980549184049408E+00,
     &   -0.162166264079867423E+00,
     &    0.116914318600378380E+02,
     &   -0.391798322451496475E+02,
     &    0.562818206920228281E+01,
     &   -0.644553013707420597E+01,
     &    0.348025250102962858E+02,
     &    0.146211513037505600E+02,
     &   -0.931620096508250839E+02,
     &   -0.414865309924659229E+02,
     &   -0.199217176194519254E+02,
     &   -0.138478745821126150E+02,
     &   -0.208631451366541008E+02,
     &    0.123364246565940849E+02,
     &   -0.150286885052886827E+02,
     &    0.626966295066295043E+01,
     &   -0.108697650608453156E+01,
     &   -0.625825815546540412E+02,
     &    0.948071225430725129E+01,
     &   -0.250161708051891729E+02,
     &    0.162493524830729186E+01,
     &    0.375554915843922921E+00,
     &   -0.838116001169705527E+01,
     &   -0.165219254571276597E+01,
     &    0.517841356205078540E+00,
     &    0.125433994014375849E+01,
     &    0.424744302426932008E+00,
     &   -0.274098253781020018E+01,
     &    0.522618619007306418E+01,
     &    0.131990656118653393E+01,
     &   -0.243564065185676437E+01,
     &   -0.104978837935588620E+01,
     &    0.465984424568485736E+02,
     &    0.282015284971946034E+01,
     &    0.525329373925557945E+02,
     &    0.396182173851073238E+00,
     &   -0.217226630266926524E+01,
     &   -0.439232718313769477E+00,
     &    0.135152204128648155E+02,
     &    0.227042937174126092E+01,
     &   -0.278502833021350815E+00,
     &    0.154072742465484347E+01,
     &    0.355166790837950153E+01,
     &   -0.167960294313713909E+01,
     &   -0.798776615595411688E+01,
     &    0.178670339056582861E+00,
     &   -0.810150644077235693E+00,
     &    0.518773188831028946E+02
     & /
      	data(wl2(i),i=1,n)/
     &    0.234218346067373453E+02,
     &   -0.227081163505429506E+01,
     &   -0.480781552262364908E+00,
     &   -0.144957531342470798E+02,
     &   -0.954800923939741786E+01,
     &   -0.166697239468445146E+01,
     &   -0.251320736585596327E+01,
     &    0.147312370653460452E+02,
     &    0.157746313255978823E+02,
     &   -0.314860573431996080E+02,
     &   -0.653180433572498553E+00,
     &   -0.521829562326790963E+01,
     &    0.323963795297751815E+02,
     &    0.278113155528110778E-01,
     &   -0.374432438354470278E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.269774248609491742E+02,
     &   -0.187346579627965006E+02,
     &   -0.890062574152115182E+01,
     &   -0.312078989678481840E+02,
     &   -0.237185691337980344E+02,
     &    0.304341546792258875E+02,
     &   -0.474387746098096059E+02,
     &   -0.297995914903452785E+02,
     &   -0.449010955024414997E+02,
     &   -0.254770119530327719E+02,
     &   -0.262430522751638726E+02,
     &    0.775441384020257907E+01,
     &    0.921584124067574884E+01,
     &    0.183071402548162006E+02,
     &    0.856666498325166827E+02
     & /
      	data b2 / 0.210102159529077248E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end


      subroutine SH2PES_i_3(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.399745033092365887E+01,
     &   -0.179705156529501231E+01,
     &    0.141470831434327127E+01,
     &   -0.497183022059835444E+01,
     &    0.323666699534982616E+01,
     &   -0.145008543172515547E+01,
     &    0.448721549330019176E+01,
     &   -0.263151617933397075E+01,
     &    0.140757455830312983E+01,
     &   -0.347984052893621953E+01,
     &    0.195615254759908797E+01,
     &    0.359235853431688046E+01,
     &    0.143427980371135444E+01,
     &    0.208311650791151681E+01,
     &   -0.119822713563391847E+01,
     &    0.903686478014241068E+01,
     &   -0.635508292602639813E+01,
     &   -0.209260169723510497E+00,
     &    0.983644842349641024E+01,
     &   -0.728237657284205131E+01,
     &   -0.954729291743119601E+00,
     &    0.104870423723866022E+02,
     &   -0.105786085677161168E+02,
     &    0.895383579322251544E+00,
     &    0.118391999905358958E+01,
     &   -0.144794322278535015E+01,
     &   -0.206302818699526505E+02,
     &    0.371542479135763815E+01,
     &   -0.272999662358572026E+01,
     &   -0.224966535356505082E+01,
     &    0.609988939721257228E+00,
     &   -0.353007592173791451E+01,
     &    0.498458660986902036E+01,
     &   -0.371898138782165333E+01,
     &    0.210276190180844091E+01,
     &    0.234576334265071162E+01,
     &    0.302870377916642264E+01,
     &   -0.100476391775744212E+01,
     &   -0.965582933284970579E+00,
     &    0.186624863031159383E+00,
     &    0.247953214024250634E+01,
     &   -0.290676833028441939E+00,
     &   -0.689118710807735546E+01,
     &    0.453258573898761519E+01,
     &   -0.886162380518207504E+00
     & /
      	data(bbi(i),i=1,m)/
     &   -0.362233470255845980E+01,
     &    0.206137463829295875E+01,
     &   -0.173201600134593203E+01,
     &    0.293465987804416439E+01,
     &    0.600598460496986203E-01,
     &   -0.340925469709520357E+01,
     &   -0.343121750538977954E+01,
     &   -0.500764879543621255E+01,
     &    0.171115928312090015E+01,
     &   -0.296238809430089711E+01,
     &    0.238861568092799592E+01,
     &   -0.618772463508377668E+00,
     &    0.103159893501756986E+00,
     &    0.172829072792468130E+01,
     &    0.141284735139913775E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.267266690086553282E+01,
     &    0.137562983929745748E+02,
     &    0.135857885864622645E+02,
     &    0.268164791928408208E+01,
     &   -0.151567180691981229E+01,
     &    0.395470422638015906E+01,
     &   -0.944419757317369823E+00,
     &   -0.497316889449003208E+00,
     &    0.256553086532852637E+00,
     &    0.161510821992880835E+02,
     &   -0.209631244585406762E+01,
     &   -0.147778562410988745E+00,
     &    0.466085002985168906E+01,
     &   -0.699368795166256429E+01,
     &   -0.831433162817154958E+00,
     &    0.540447495022392399E+01,
     &    0.190676223238977549E+01,
     &    0.245391639259722760E+01,
     &   -0.502089842149524657E+01,
     &   -0.458331149568291657E-01,
     &    0.962851822019830550E+00,
     &    0.259696906872585731E+00,
     &    0.998820641332081594E-01,
     &   -0.158278477469202650E+00,
     &   -0.117332857958919270E+02,
     &    0.837071526735397065E+01,
     &   -0.370546662392296033E+01,
     &   -0.674981873029964774E+01,
     &    0.159816658741128892E+01,
     &   -0.217007659164438582E+01,
     &   -0.382261298226574286E+01,
     &    0.169244692959899501E+01,
     &    0.318042393796691236E+01,
     &    0.603716185673429884E+00,
     &    0.653315727169403226E+00,
     &    0.401672806531286897E+00,
     &    0.364181125040112297E+00,
     &    0.370215274896752780E-01,
     &    0.249342731042977023E+00,
     &    0.188377754972559330E+01,
     &    0.134841477058801673E+01,
     &    0.211173257369067890E+01,
     &    0.271094360693562431E+01,
     &   -0.598048335588535984E+01,
     &   -0.124304595342851809E+01,
     &   -0.316309388529081481E+02,
     &    0.507418414056235747E+02,
     &    0.837533167553041551E+02,
     &   -0.133842199479415598E+03,
     &   -0.706700840676994204E+02,
     &   -0.817212080376703227E+02,
     &    0.441665221694179380E+02,
     &   -0.481973661790677568E+02,
     &    0.134949319393650669E+02,
     &   -0.130936074447916553E+03,
     &   -0.262781327934079867E+01,
     &    0.329787310897298340E+02,
     &    0.848764539101485695E+02,
     &   -0.306511753240140905E+02,
     &   -0.172015338593742854E+03,
     &    0.334272271170058843E+01,
     &    0.346188079671888804E+01,
     &    0.411801370090920837E+01,
     &   -0.273156462806266465E+01,
     &   -0.860916461273890099E-01,
     &    0.831229357222261211E+00,
     &    0.539368038286454493E-01,
     &    0.370972964004626718E-01,
     &    0.512994042672813011E-01,
     &   -0.447027482872533177E+01,
     &    0.875195636552598799E+00,
     &   -0.345121375388606211E+01,
     &   -0.665905200009642950E+01,
     &    0.184664516985958826E+01,
     &   -0.204586431289744652E+01,
     &   -0.141755742552183392E+03,
     &   -0.588142513038632799E+02,
     &   -0.171346817078738383E+03,
     &   -0.478281219970126941E+02,
     &    0.124412477839496605E+01,
     &    0.145698063125551300E+02,
     &   -0.397278059009292832E+02,
     &   -0.428153813781594650E+01,
     &   -0.108795093290301956E+02,
     &   -0.751002447226291565E+02,
     &   -0.253922197364412128E+02,
     &    0.950559839406143681E+02,
     &    0.129644880259487053E+03,
     &    0.307700984416748859E+02,
     &   -0.600263262376371145E+02,
     &    0.268371259803945494E+00,
     &   -0.303997069870548309E+01,
     &   -0.273155980202354698E+01,
     &   -0.873452575234722417E+01,
     &   -0.149024019686893272E+01,
     &   -0.352594165894375289E+01,
     &    0.635638462119269665E+00,
     &    0.363002017338378280E+00,
     &    0.604141998919033793E-01,
     &   -0.176836337417591061E+02,
     &    0.601006414075953010E+01,
     &    0.573611753997184670E+00,
     &    0.119136997666106392E+01,
     &    0.244500746835367400E+01,
     &    0.120393054221240448E+01,
     &   -0.137469882327646054E+01,
     &    0.577577181523970573E+01,
     &    0.541882363266669831E+01,
     &    0.152775735067097096E+01,
     &   -0.626640054133855567E-01,
     &    0.155296137578182569E+01,
     &   -0.689234786055413218E+00,
     &    0.174987103216542761E+00,
     &    0.429783637078362951E-01,
     &    0.458779453704866924E+01,
     &    0.514542313163440390E+01,
     &    0.661195037210328573E+00,
     &   -0.593233282448116100E-01,
     &   -0.191424740119328951E+01,
     &    0.672609507876159807E+00,
     &   -0.519466709883335542E-01,
     &    0.709710568214271120E+01,
     &    0.705067188883820162E+01,
     &    0.458861253654456558E+01,
     &    0.360360552538546777E-01,
     &    0.108519231862964438E+01,
     &    0.481208430072949001E+00,
     &    0.972948561873975964E-01,
     &   -0.143607768529382205E-01,
     &    0.106949997103360506E+02,
     &    0.192140253083562662E+01,
     &    0.451091450754924295E+00,
     &   -0.161031993555515007E+00,
     &   -0.268329515427319221E+01,
     &    0.159438644835321663E+01,
     &   -0.401643457223850575E+01,
     &   -0.130738649711523447E+02,
     &   -0.134068900282896131E+02,
     &   -0.399409165603886229E+00,
     &    0.259910800047845336E+00,
     &    0.152364810502273862E+01,
     &   -0.152919805937549502E+01,
     &   -0.636776213642813518E-02,
     &   -0.605356585279047121E-01,
     &   -0.336390951599645582E+01,
     &    0.844245672307452821E+02,
     &    0.322799252965860928E+00,
     &   -0.244724129934729762E+01,
     &    0.367900613467932569E+01,
     &   -0.652565111363442640E+00,
     &   -0.124358259760460721E+00,
     &   -0.465956749735543951E+01,
     &   -0.460280551486972911E+01,
     &   -0.133520343254266138E+01,
     &    0.154113767618104025E+00,
     &   -0.304240428409718877E+00,
     &   -0.467439959549189488E+00,
     &   -0.270023106411355282E-01,
     &   -0.746971049330089759E-01,
     &   -0.425261506692901747E+01,
     &   -0.819348258877260593E+00,
     &   -0.836239090138962554E-01,
     &   -0.197496722558208671E+01,
     &    0.269772425957536521E+01,
     &    0.273675850854721237E+00,
     &    0.756025629077897832E+00,
     &   -0.572317771100345407E+01,
     &   -0.533518844903542000E+01,
     &   -0.107295005282865796E+01,
     &    0.155052945491560318E+00,
     &   -0.155029433668014538E+01,
     &    0.616354199502151756E+00,
     &   -0.165240948727885251E+00,
     &   -0.339334380872087019E-01,
     &   -0.376683243354646402E+01,
     &   -0.460941580520507177E+01,
     &   -0.539970689907774193E+00,
     &   -0.536938515301483399E+00,
     &    0.231755564190900776E+01,
     &   -0.483149434275293110E+00,
     &    0.569735822463413380E-01,
     &    0.468345432170046116E+01,
     &    0.461857328830375025E+01,
     &    0.140085528366277945E+01,
     &   -0.130176641447173280E+00,
     &    0.267153883662209157E+00,
     &    0.520713348221010563E+00,
     &    0.165452019141094399E-01,
     &    0.728525603590731013E-01,
     &    0.436676914109357650E+01,
     &    0.758018762355124553E+00,
     &    0.662010782330597486E-01,
     &    0.189405994644049769E+01,
     &   -0.267004445956701719E+01,
     &   -0.288620839753426506E+00,
     &   -0.199186474323539997E+02,
     &   -0.591193404873518524E+01,
     &   -0.417748158620397003E+01,
     &    0.458638506820470226E+01,
     &   -0.628838666179333039E+00,
     &    0.236156375764103379E-01,
     &   -0.330258906623589743E+01,
     &   -0.711185347853778294E+00,
     &   -0.350862731267984618E-01,
     &    0.901001571853920247E+01,
     &    0.429976736397170356E+01,
     &    0.147012684588869735E+02,
     &    0.265628942089866875E+02,
     &   -0.107958811118227711E+02,
     &    0.413060813496609214E+01,
     &   -0.191163003024305844E+02,
     &   -0.526856531665129690E+01,
     &   -0.354022852418677259E+01,
     &    0.192193459260694866E+01,
     &   -0.653269272772552090E+00,
     &   -0.112403102756976694E+00,
     &   -0.310332718936836383E+01,
     &   -0.705242870076203898E+00,
     &   -0.370103047311295535E-01,
     &    0.797579448715407224E+01,
     &    0.539678738816122561E+01,
     &    0.145202582153887700E+02,
     &    0.261789766950002445E+02,
     &   -0.107101772779371363E+02,
     &    0.406871424116905800E+01
     & /
      	data(wl2(i),i=1,n)/
     &    0.265710455372109577E+00,
     &    0.948057595663268193E+00,
     &    0.403972239083563380E+02,
     &    0.520445439800115395E+02,
     &   -0.151950939550057984E+01,
     &   -0.453060907124854779E+02,
     &   -0.202096119392628886E+02,
     &    0.514691548619578487E+01,
     &    0.197920017492490996E+01,
     &   -0.400496858762636132E+00,
     &   -0.317626091123433767E+02,
     &    0.755802457799989202E+01,
     &   -0.325502988572425096E+02,
     &   -0.733320942361859665E+02,
     &    0.972670118527780261E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.189014155436974427E+02,
     &   -0.131704910303170362E+02,
     &    0.325102806709486103E+01,
     &   -0.223311444199883340E+03,
     &   -0.277140862106519048E+01,
     &   -0.133217519587548793E+03,
     &   -0.196920762090002519E+02,
     &   -0.412122696646127828E+00,
     &    0.766950397897003011E+01,
     &   -0.924135753550032604E+02,
     &   -0.231692877062340719E+01,
     &    0.873603073178531447E-01,
     &    0.237836805695554121E+01,
     &   -0.780021767001161503E+01,
     &   -0.649333031926287418E+01
     & /
      	data b2 / 0.119386554681722572E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end

      subroutine SH2PES_i_4(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.265943679804494382E+01,
     &   -0.775771305960993529E+00,
     &    0.177086504751604201E+00,
     &   -0.120851666613773223E+01,
     &    0.293156351389095127E+01,
     &    0.126527393907951580E+01,
     &   -0.427973430415115530E+01,
     &    0.129763828916613733E+01,
     &    0.526589279844546732E+00,
     &   -0.204863327387387351E+01,
     &    0.144237139156685590E+01,
     &   -0.124365171593494619E+02,
     &    0.181843297519766942E+02,
     &   -0.159586470752197052E+02,
     &   -0.138998705230581376E+01,
     &   -0.217394984269686198E+01,
     &    0.185615838418377432E+01,
     &   -0.132587463799241445E+01,
     &    0.318798720792172335E-01,
     &    0.158750263014516158E+01,
     &    0.647487699050893539E+00,
     &    0.385824733899522210E+01,
     &   -0.170183555801449304E+01,
     &   -0.492907142329798209E+00,
     &    0.313483750836160757E+00,
     &    0.574210847562304938E+01,
     &   -0.122581541780986587E+02,
     &   -0.296765539573296433E+01,
     &    0.144316013467124682E+01,
     &    0.206124097665808659E+01,
     &   -0.147600445027693694E+01,
     &    0.159539223414625297E+01,
     &   -0.147821480277923167E+01,
     &   -0.529893906409110738E+01,
     &    0.366409320868696442E+01,
     &    0.792594215789226175E+00,
     &   -0.439191212427535227E+01,
     &    0.168788025361194660E+01,
     &   -0.619904952177482760E+00,
     &   -0.569253426487629888E+00,
     &   -0.206256101059475894E+01,
     &    0.275464442107398222E+01,
     &    0.169619867139192082E+01,
     &   -0.496135808384791233E+01,
     &    0.376244751443983450E+00
     & /
      	data(bbi(i),i=1,m)/
     &   -0.163473495386867462E+01,
     &    0.290586370955664242E+01,
     &    0.237230441555994664E+01,
     &    0.195040614993767125E+01,
     &   -0.900074251171195350E+01,
     &    0.514211045038876935E+00,
     &   -0.582327959607351175E+00,
     &   -0.116952217552324234E+01,
     &   -0.504945370588912379E+01,
     &   -0.392660368389971426E+00,
     &    0.139685186962849550E+01,
     &    0.102245982671559221E+01,
     &    0.365579383898193688E+01,
     &   -0.281918835907854959E+01,
     &   -0.312398705004850497E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.586191083936098423E+01,
     &    0.634176039976598549E+01,
     &    0.152519547726175775E+01,
     &   -0.460487150138757073E+00,
     &   -0.434500676564962107E+00,
     &    0.614516554508635515E+00,
     &   -0.830019508992159816E+00,
     &   -0.215214413254243153E+01,
     &   -0.700412456097086689E+00,
     &   -0.993674523829093048E+00,
     &    0.740539781406098441E+00,
     &    0.163061261483696374E+01,
     &    0.401772551052980997E+01,
     &    0.688027017175856681E+00,
     &    0.333366652119535534E-01,
     &    0.575894742537375759E+01,
     &    0.648534099030309363E+01,
     &    0.147942956601224584E+01,
     &   -0.450359252027957291E+00,
     &   -0.431011266658405445E+00,
     &    0.454614865972476967E+00,
     &   -0.773081842881196302E+00,
     &   -0.220825948876733102E+01,
     &   -0.145788956956951543E+00,
     &   -0.769673516268106983E+00,
     &    0.977331091152690123E+00,
     &    0.155973679103653473E+01,
     &    0.395600499230328939E+01,
     &    0.587118360631135205E+00,
     &    0.281273433459009181E-01,
     &   -0.808928309376245913E+01,
     &   -0.283137514756672237E+01,
     &   -0.228944699578732136E+01,
     &   -0.158645834284651260E-01,
     &    0.244050275754087498E+00,
     &   -0.244774997473881006E+01,
     &    0.144008684064920600E+01,
     &    0.223299931577435640E+01,
     &    0.293515252229246737E+00,
     &    0.726740539262899277E+00,
     &    0.532684894318938507E+00,
     &    0.168232963382805756E+01,
     &    0.892371261285492601E+00,
     &   -0.117975395755551909E+00,
     &    0.213477371467568711E+01,
     &    0.140768368881683159E+02,
     &    0.157373300384784631E+02,
     &    0.558050457739910399E+02,
     &   -0.155610633693988021E+02,
     &    0.200303218857805625E+02,
     &    0.630682783739299921E+02,
     &    0.198741779736679014E+02,
     &    0.209099831262017553E+02,
     &    0.167211540378843715E+02,
     &    0.495321320655016848E+02,
     &    0.791908328061785056E+02,
     &    0.306708182011871493E+02,
     &    0.823082416967137931E+02,
     &    0.319081871660392835E+01,
     &   -0.203730783278952288E+02,
     &    0.577805799072353188E+00,
     &    0.577069449511445676E+01,
     &   -0.121797482055973227E+01,
     &   -0.598615256722629940E+00,
     &   -0.562738871166160948E+00,
     &    0.507489925043033835E-01,
     &   -0.596866623741705432E-01,
     &   -0.187567678907543267E+01,
     &   -0.165414135532078199E+01,
     &    0.214158550805173720E+01,
     &    0.253534218675794065E+01,
     &    0.514491708543601156E+00,
     &    0.363183732166585305E+01,
     &   -0.809827800339102732E+00,
     &   -0.185477047874063605E+00,
     &    0.391908947962375809E+01,
     &   -0.601217150231628672E+01,
     &    0.936091575093627060E+00,
     &    0.413869821330284993E+00,
     &    0.545930247745064601E+00,
     &   -0.368452423815378660E+01,
     &   -0.816064455367486508E+00,
     &    0.357172431955554370E+00,
     &   -0.549286715214089893E+00,
     &    0.174720432631045397E+01,
     &    0.349395262697120312E+01,
     &   -0.210204599402762105E+01,
     &    0.662323605662086590E+00,
     &   -0.375611920271748834E+00,
     &    0.253017100285741425E+00,
     &   -0.309446192250006780E+01,
     &   -0.445737598156902859E+01,
     &   -0.587644378877892448E+00,
     &   -0.196798460378751761E+00,
     &    0.197947180970648701E+00,
     &    0.688603173173932825E+00,
     &    0.418747721794183292E+00,
     &    0.210894017908622100E+01,
     &   -0.150047222725265117E+01,
     &    0.290795776539056972E+00,
     &    0.104641520229637286E+01,
     &    0.740270138826464530E+00,
     &    0.245390557855019981E+00,
     &    0.112165449369750592E+01,
     &    0.331142574653389588E+00,
     &   -0.426519784613758191E+01,
     &   -0.673019834008336115E+01,
     &   -0.641779269340006953E+00,
     &    0.459574426612353093E+00,
     &    0.466039154124522959E+00,
     &   -0.137234222929396105E+00,
     &    0.474760372657229701E+00,
     &    0.238640843765521371E+01,
     &   -0.135135360801361970E+01,
     &   -0.631579360391718581E+00,
     &   -0.186894373478667752E+01,
     &   -0.978549456022846820E+00,
     &   -0.364716127505011078E+01,
     &   -0.129739432960992249E-01,
     &    0.570877796531703702E-01,
     &   -0.541757596375263688E+02,
     &   -0.118224670769995743E+02,
     &   -0.228051458153270197E+02,
     &   -0.355111101863677059E+00,
     &   -0.213131352525724616E+02,
     &   -0.789292024814550786E+01,
     &    0.139086097394730857E+02,
     &    0.518674624030142866E+02,
     &    0.424927698905021174E+02,
     &   -0.962380611314344314E+01,
     &   -0.270464121070020553E+02,
     &    0.241059337571119769E+02,
     &    0.113633455398616992E+02,
     &    0.122151826112312403E+02,
     &   -0.506376486167139461E+02,
     &   -0.536547751281154905E+01,
     &    0.645279970602369879E+01,
     &   -0.278996128870285398E+01,
     &   -0.111558896616390246E+01,
     &    0.280100462071667389E+00,
     &   -0.216991855217795049E+01,
     &    0.479390898711493041E+00,
     &   -0.657167978780543893E+00,
     &    0.159984671594579919E+01,
     &    0.206577423368107277E+00,
     &    0.151030778310883251E+01,
     &    0.243030487528379346E+01,
     &   -0.291334926442105990E+01,
     &   -0.174630322570596253E+01,
     &    0.292722863412249353E-01,
     &   -0.518626160745066489E+01,
     &   -0.345109890576036227E+01,
     &   -0.204832953724208444E+01,
     &   -0.252282368545700963E+00,
     &    0.252309622664872446E+00,
     &   -0.168777330119154217E+00,
     &    0.170710868636766744E+01,
     &    0.211993738434322410E+01,
     &   -0.796861174021961660E+00,
     &    0.195839168568670297E+01,
     &    0.242041422202554379E+01,
     &    0.723842677435113879E+00,
     &    0.265823796900984632E+01,
     &   -0.487438347332844968E+00,
     &    0.391165790926547963E+00,
     &   -0.362625561901829574E+01,
     &    0.134253515088509463E+02,
     &   -0.276464341864032193E+01,
     &   -0.355615138646477424E+00,
     &   -0.104119594780926743E+02,
     &   -0.218150507112764291E+01,
     &    0.306449825061476933E+01,
     &   -0.498443476170302713E+01,
     &    0.122307403607880367E+02,
     &   -0.376899500321917380E+00,
     &    0.741531967712877993E+00,
     &    0.405544661897675740E+00,
     &    0.343547943614168982E+01,
     &   -0.192910460546756757E+01,
     &   -0.282209027970440163E+01,
     &   -0.586714835205549567E+00,
     &    0.675127631830083086E+01,
     &   -0.193111727247878195E+01,
     &   -0.674625043574770683E-01,
     &   -0.480269558211013414E+00,
     &    0.578465043357705522E+01,
     &   -0.444158718167275424E+00,
     &   -0.183252486080642096E+00,
     &    0.609589416894123715E+00,
     &   -0.489550824546681262E+01,
     &   -0.853323165443326914E+01,
     &   -0.549428632465456257E+00,
     &   -0.573054178809711345E+01,
     &    0.534072321543119344E+00,
     &    0.348027116705703687E+00,
     &    0.339337795437658674E+01,
     &   -0.135037628045433937E+02,
     &    0.298330955335286907E+01,
     &    0.330798896794136932E+00,
     &    0.104530493195750527E+02,
     &    0.268015799605004057E+01,
     &   -0.276530316421866873E+01,
     &    0.505973482063057478E+01,
     &   -0.126631293484859260E+02,
     &    0.302895347165687445E+00,
     &   -0.106238294381817067E+01,
     &   -0.941072463611355214E+00,
     &   -0.314141505804670729E+01,
     &    0.201461361148370122E+01,
     &    0.329385165212626152E+01,
     &   -0.604700899739030406E+00,
     &   -0.631124622247357614E+01,
     &    0.144992645635893425E+01,
     &    0.506258123044824315E-01,
     &    0.432994955545884130E+00,
     &   -0.542768441266770640E+01,
     &    0.602094154802339854E+00,
     &    0.733198803789995246E+00,
     &   -0.334698191743811935E+00,
     &    0.445695428190321863E+01,
     &    0.762380644215624681E+01,
     &    0.685697666961073815E+00,
     &    0.507531962806810366E+01,
     &   -0.518953580808924397E+00,
     &   -0.260579824840459162E+00
     & /
      	data(wl2(i),i=1,n)/
     &    0.223297820834145853E+02,
     &   -0.275016192883613577E+02,
     &    0.170510660067413227E+02,
     &   -0.225831022328453948E+02,
     &   -0.222087141938921384E+01,
     &    0.437275332231968406E+00,
     &   -0.114938985915268566E+01,
     &   -0.789711031478877601E+01,
     &    0.616410705052574404E+01,
     &   -0.679896886742535761E-01,
     &    0.221376477865565224E+01,
     &   -0.230049278315328154E+01,
     &   -0.206441297669606598E+02,
     &   -0.207886803815547694E+01,
     &   -0.284807043476255473E+02
     & /
      	data(b1(i),i=1,n)/
     &   -0.831206414180523012E+01,
     &   -0.799083936221178703E+01,
     &    0.461685925224777716E+01,
     &   -0.103886262751861107E+02,
     &   -0.105469166376604662E+02,
     &    0.334117664166371053E+01,
     &    0.406047257039458387E+01,
     &    0.717660468122216688E+01,
     &   -0.372909881391698903E+02,
     &   -0.389766576004014587E+01,
     &    0.141304629682459471E+01,
     &   -0.194764725446423732E+02,
     &    0.998311301044795818E+00,
     &    0.192020134567714038E+02,
     &   -0.550877868113024527E+00
     & /
      	data b2 / 0.173937061892301230E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end



      subroutine SH2PES_i_5(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &   -0.377066476627628910E+01,
     &    0.904487889241050169E+00,
     &   -0.149687877620477150E+01,
     &    0.243991059210114880E+01,
     &    0.220801786453087789E+01,
     &   -0.609011620391419495E+01,
     &   -0.984181040535435231E-01,
     &    0.275934719277438734E+00,
     &    0.149781024707977117E+01,
     &   -0.145137182877854887E+02,
     &    0.131064133463913830E+02,
     &    0.126446799644410168E+01,
     &    0.120417268740547506E+00,
     &   -0.489297149712185520E+00,
     &    0.357755022706890458E+01,
     &   -0.118130752938623136E+02,
     &    0.681619116811423265E+01,
     &   -0.711994600185760995E+00,
     &   -0.829141636362702528E+01,
     &    0.542624057067246479E+01,
     &    0.603940770464833965E+00,
     &    0.298815342631603276E+01,
     &    0.275186413770319105E+00,
     &    0.500240269795179771E+00,
     &   -0.590266592250015432E+00,
     &   -0.105241558268876378E+01,
     &    0.102281191751272171E+01,
     &   -0.568113085815963204E+00,
     &    0.220062998199634974E+01,
     &   -0.451219575311547383E+00,
     &    0.165548776176679652E+00,
     &   -0.745032262860926608E+00,
     &    0.411482952734579133E+01,
     &   -0.404950039341289525E+01,
     &    0.695633872769808725E+01,
     &   -0.787085539539776313E+01,
     &   -0.218126597667855737E+01,
     &   -0.591751710397385722E-01,
     &    0.301384733271209049E+01,
     &    0.147898092214702270E+01,
     &   -0.589518757082389477E+01,
     &    0.886810426149936881E+00,
     &    0.549729018339473408E+00,
     &   -0.206774374904528635E+01,
     &   -0.894633763867844323E+00
     & /
      	data(bbi(i),i=1,m)/
     &    0.425734802586874927E+01,
     &   -0.446716887266421026E+01,
     &   -0.941347343823821903E+00,
     &    0.739067556643648604E+01,
     &   -0.263203999054538174E+00,
     &    0.667790018277888642E+01,
     &    0.300643291081934816E+01,
     &   -0.449634310392714842E+00,
     &    0.965176912019186206E+00,
     &    0.932122688186538428E+00,
     &   -0.159139345264038545E+01,
     &   -0.112114523665963173E+01,
     &   -0.531654576292711178E+00,
     &   -0.385636220404041907E+01,
     &   -0.260268679561960026E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.188927792805552275E+01,
     &    0.235635490480557497E+01,
     &    0.278864776460508068E+02,
     &   -0.131458732432161635E+00,
     &   -0.793941948282014387E+01,
     &   -0.231235924006972619E-01,
     &   -0.987488876194441589E+00,
     &   -0.108690494177308294E+01,
     &    0.573520323826626832E+01,
     &    0.127056363892407020E+01,
     &    0.307609935352413766E+01,
     &    0.342515708696341070E+00,
     &    0.127438051876045866E+01,
     &   -0.198520669088120910E+00,
     &    0.104560451998122588E+02,
     &    0.469010103519440724E+00,
     &   -0.228369101826595511E+01,
     &    0.367131179246603212E+00,
     &    0.280399429449062376E+00,
     &    0.315320265480055373E+00,
     &    0.298651088876252968E+00,
     &    0.468603199918793567E+00,
     &   -0.468572837847969326E+00,
     &    0.949283268261850610E+00,
     &    0.159125550628590662E+01,
     &   -0.111035701533778064E+00,
     &    0.273095397458624822E+00,
     &    0.288771319913160518E+00,
     &    0.357360438768669186E+00,
     &   -0.641065419192424368E+01,
     &    0.208901247028003478E+01,
     &    0.763845995959445134E+00,
     &    0.154375069982945545E+01,
     &    0.220948112831463067E+00,
     &    0.311128861882908503E+00,
     &   -0.664986243951388861E-01,
     &    0.348137706214537379E+00,
     &   -0.994730189410979737E-01,
     &   -0.915356487232861560E+00,
     &    0.179982287297476673E+00,
     &   -0.933755512717022618E+00,
     &    0.252778706738028436E+00,
     &    0.163798691071401978E-01,
     &    0.307509694842623360E+00,
     &   -0.575004268831536702E+01,
     &   -0.433116956590727931E+01,
     &   -0.175469963490808496E+02,
     &    0.140025427102392697E+01,
     &   -0.653000190809360426E+01,
     &   -0.230842129766937942E+01,
     &    0.400554699535700109E+01,
     &    0.125671745655557721E+00,
     &    0.210054293401799574E+01,
     &   -0.203596615158949801E+01,
     &    0.105754176988661200E+00,
     &   -0.365433263574106548E+00,
     &   -0.503761566554887086E+01,
     &   -0.693079688166937213E+00,
     &    0.182536206410546176E+01,
     &    0.828135059862826495E+01,
     &    0.364904405176610047E+00,
     &   -0.447666499944523277E+01,
     &    0.174127511385169881E+00,
     &    0.418583687686207129E+00,
     &    0.133499065960028185E+01,
     &   -0.438102537579537488E-01,
     &    0.122743001626759288E+00,
     &   -0.159480577491533208E-01,
     &    0.359033697906565918E+00,
     &   -0.921145449797316496E-01,
     &    0.128337540858419863E+00,
     &    0.717968471552592913E+00,
     &   -0.490092381961910045E-01,
     &   -0.199550218852999166E-01,
     &   -0.377080706379628428E+01,
     &   -0.155680474203758301E+01,
     &    0.845247569342343796E+00,
     &   -0.284277052972672584E+00,
     &   -0.418794965834862809E+00,
     &   -0.559322213441717841E+00,
     &   -0.559787854708336030E+00,
     &   -0.306653747113764363E+00,
     &    0.665309507029943625E+00,
     &    0.135622455922338375E+00,
     &   -0.146461393666865258E+01,
     &   -0.306756790980705130E+00,
     &   -0.851457183306327137E+00,
     &   -0.307554326999675727E-01,
     &    0.271403435017139316E+00,
     &    0.102333833277363571E+02,
     &   -0.132368512082210205E+00,
     &   -0.115736334890560699E+01,
     &   -0.367203836643429982E+00,
     &    0.377004438746656345E+00,
     &    0.652987477243481829E+00,
     &    0.271992063901279169E+00,
     &    0.396592724745917002E+00,
     &   -0.648802391103363352E+00,
     &   -0.329944699919626827E+00,
     &    0.116379921367548178E+01,
     &   -0.290724383956559085E+00,
     &    0.619703663835597607E+00,
     &    0.246387299546316607E+00,
     &   -0.212469906550456333E+00,
     &   -0.184569447107186555E+02,
     &   -0.429239281854105137E+01,
     &   -0.171034583132077671E+02,
     &    0.138862411819851239E+01,
     &   -0.651587553385039175E+01,
     &   -0.231878598117708190E+01,
     &    0.386487025261619355E+01,
     &    0.104035367112008642E+00,
     &    0.208215740105178471E+01,
     &   -0.201519262886248995E+01,
     &    0.631331615098446458E-01,
     &   -0.341514547980559080E+00,
     &   -0.507079788115819241E+01,
     &   -0.716384115349815054E+00,
     &    0.181314052254200386E+01,
     &    0.829414421198869611E+01,
     &   -0.234582612125285443E+02,
     &    0.231838547012509117E+02,
     &    0.525615341117238160E+02,
     &    0.374133838819902422E+02,
     &    0.196177325808478216E+02,
     &    0.587538650024496860E+02,
     &   -0.791828905356001655E+02,
     &   -0.330288723610130148E+02,
     &   -0.182546443995740582E+02,
     &    0.151538477496557391E+02,
     &    0.143679770046813915E+01,
     &    0.341617038393767913E+02,
     &    0.214485990738944338E+00,
     &   -0.123691101756661723E+02,
     &    0.160078408974760116E+02,
     &   -0.349700516099106196E+01,
     &   -0.154250441084268886E+02,
     &    0.591676223121082767E+01,
     &    0.402346974225287646E+01,
     &   -0.788550172662234061E+01,
     &   -0.199955369587152321E+01,
     &   -0.860161118961894111E+01,
     &   -0.257775293046609333E+01,
     &   -0.589343155245662143E+01,
     &   -0.325035461065332498E+01,
     &    0.785849388533403914E+01,
     &    0.373312692216302411E+01,
     &    0.610774885364931200E-01,
     &   -0.462388502880750085E+01,
     &   -0.190361148388974044E+01,
     &   -0.224570873786780334E+01,
     &   -0.977556764008880807E+00,
     &   -0.328650665249347229E+01,
     &    0.684760365296882667E+00,
     &    0.848725415107835279E+00,
     &   -0.388389015865117204E+00,
     &   -0.515607517617134636E+00,
     &   -0.203068838688577308E+00,
     &   -0.146718643871573762E+01,
     &   -0.136719843451867296E+01,
     &   -0.976888829330467501E+00,
     &    0.122599880385053384E+01,
     &   -0.370777390877521859E-01,
     &    0.351138749993552046E+00,
     &   -0.136972710229412780E+02,
     &   -0.297344847640594379E+00,
     &   -0.813737895933919542E+00,
     &   -0.506668574660619764E+00,
     &   -0.265474204304581629E+00,
     &   -0.199497547636858230E+00,
     &    0.891875492116800117E-01,
     &   -0.372427782552394115E+00,
     &    0.136316099723683221E+00,
     &   -0.357119069604160955E+00,
     &   -0.597855486249654122E+00,
     &    0.514608721525914997E-01,
     &   -0.240332972334224043E+00,
     &   -0.203181128695138630E+00,
     &   -0.229186575014949240E+00,
     &    0.587474411054510259E+01,
     &   -0.296615781892764687E+02,
     &   -0.115527722704773836E+02,
     &   -0.874533535822897612E+01,
     &    0.290989070009293087E+02,
     &    0.106784221124966550E+02,
     &   -0.373561158350649549E+02,
     &   -0.356661950977449820E+02,
     &   -0.153030254407689092E+02,
     &   -0.201266064486332752E+02,
     &   -0.231616875498969890E+02,
     &    0.144990439133222662E+02,
     &   -0.256576171158234878E+02,
     &    0.522707598736538426E+01,
     &   -0.590622154675870092E+01,
     &   -0.271804903708361234E+01,
     &    0.123589426834176774E+01,
     &   -0.134607754959497044E+02,
     &    0.192991577875964881E+00,
     &    0.519288158240044595E+00,
     &   -0.756917220633728149E+01,
     &   -0.936427880995059025E+00,
     &    0.797212581916357688E+00,
     &    0.219119971269343816E+01,
     &    0.420996701701795650E+00,
     &   -0.423736155028612771E+01,
     &    0.514862273369415391E+01,
     &    0.145267314961534399E+01,
     &   -0.236444919043028534E+01,
     &   -0.152492274416940288E+01,
     &    0.277041224204285044E+02,
     &    0.230439346621206820E+01,
     &    0.301199961768226316E+02,
     &    0.462365953758722525E+00,
     &   -0.163363680188272520E+01,
     &   -0.111249620402833793E+01,
     &    0.486086892786889457E+01,
     &    0.204137729868183637E+01,
     &   -0.177138272785969136E+00,
     &    0.170628122479230782E+01,
     &    0.329895870852140094E+01,
     &   -0.135523480876982805E+01,
     &   -0.871042346776560272E+01,
     &    0.402850523963640406E-01,
     &   -0.571444625262798600E+00,
     &    0.281935425501664874E+02
     & /
      	data(wl2(i),i=1,n)/
     &    0.978189391037343725E+01,
     &   -0.314584274499385153E+01,
     &   -0.486358899250935950E+00,
     &   -0.135702095471838717E+02,
     &   -0.121856411591117766E+02,
     &   -0.201905811562855231E+01,
     &   -0.326994200944529778E+01,
     &    0.138097467275698218E+02,
     &    0.113638987619035099E+02,
     &   -0.168844171941935741E+02,
     &   -0.806017886756236090E+00,
     &   -0.656644545166260674E+01,
     &    0.175076010916732052E+02,
     &    0.326303187018748136E-01,
     &   -0.177573222406021003E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.337793052756570944E+02,
     &   -0.991800362907629030E+01,
     &   -0.507712923220448253E+01,
     &   -0.154018024445481516E+01,
     &   -0.107104688687635043E+02,
     &    0.130776384651465598E+02,
     &   -0.204841647535547295E+02,
     &   -0.105301486570028247E+01,
     &   -0.507608026466603768E+01,
     &   -0.138119691377323619E+02,
     &   -0.134806731156396555E+02,
     &    0.540176960495167968E+01,
     &   -0.113134525594476099E+02,
     &    0.170092908995028296E+02,
     &    0.469350267637892813E+02
     & /
      	data b2 / 0.752993120516275560E+01/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end



      subroutine SH2PES_i_6(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &   -0.409025795339410525E+01,
     &    0.106961867447981018E+01,
     &   -0.149444426155277310E+01,
     &    0.242507059092872401E+01,
     &    0.221791287842198059E+01,
     &   -0.610225680788391589E+01,
     &   -0.921749092723235935E-01,
     &    0.265294303430867462E+00,
     &    0.148185606694230954E+01,
     &   -0.145058270531756222E+02,
     &    0.130878371001659204E+02,
     &    0.125768669696320989E+01,
     &    0.119560988574360844E+00,
     &   -0.481989199500072518E+00,
     &    0.354605072036798674E+01,
     &   -0.116958498302285907E+02,
     &    0.675237268194584672E+01,
     &   -0.730520713273502986E+00,
     &   -0.834481633313767546E+01,
     &    0.544599521557879385E+01,
     &    0.614007588561609086E+00,
     &    0.295681219700024656E+01,
     &    0.289805759462694712E+00,
     &    0.491941021554238189E+00,
     &   -0.614611250947794230E+00,
     &   -0.107373295672052094E+01,
     &    0.107175066115327833E+01,
     &   -0.570574629802582334E+00,
     &    0.221741682442512822E+01,
     &   -0.453345706821549232E+00,
     &    0.168346499140997086E+00,
     &   -0.755901078009969973E+00,
     &    0.412851391269387058E+01,
     &   -0.405508569224785287E+01,
     &    0.697987870172557745E+01,
     &   -0.790991857943833843E+01,
     &   -0.227915718460195960E+01,
     &    0.538703384181859687E-01,
     &    0.297214949449640198E+01,
     &    0.146868414517861123E+01,
     &   -0.591048280041283380E+01,
     &    0.901992153954622733E+00,
     &    0.550508197807647703E+00,
     &   -0.207633201944550416E+01,
     &   -0.890288040745589870E+00
     & /
      	data(bbi(i),i=1,m)/
     &    0.443790021458835060E+01,
     &   -0.455797140029212056E+01,
     &   -0.925482619936480511E+00,
     &    0.738450190610359947E+01,
     &   -0.253590663316453302E+00,
     &    0.669263461618243127E+01,
     &    0.302358030605050088E+01,
     &   -0.436613013405502959E+00,
     &    0.979200926047268272E+00,
     &    0.930974106224515152E+00,
     &   -0.160193152193368737E+01,
     &   -0.112840802848696486E+01,
     &   -0.463497281113242399E+00,
     &   -0.386493423838937655E+01,
     &   -0.266737821406982656E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.148939353462668667E+01,
     &    0.330429007605215652E+01,
     &    0.278081498793243362E+02,
     &   -0.123560890920682384E+00,
     &   -0.809529620333317901E+01,
     &   -0.119410598314231599E-01,
     &   -0.988110253189558807E+00,
     &   -0.107579574479046802E+01,
     &    0.549559561583189726E+01,
     &    0.111554304171285246E+01,
     &    0.299275987573517144E+01,
     &    0.204557188553939617E+00,
     &    0.128761508999316088E+01,
     &   -0.220735667100241340E+00,
     &    0.115558998232370449E+02,
     &    0.486557086249744253E+00,
     &   -0.274341420984707662E+01,
     &    0.335327011630322303E+00,
     &    0.281095872391998791E+00,
     &    0.321375791791564169E+00,
     &    0.328878423820339716E+00,
     &    0.464536963959999716E+00,
     &   -0.472392428885474780E+00,
     &    0.917206963017113575E+00,
     &    0.157821139918865394E+01,
     &   -0.112170040517972289E+00,
     &    0.271302218504455239E+00,
     &    0.297059099075173694E+00,
     &    0.352588098846509435E+00,
     &   -0.712659636467542423E+01,
     &    0.214848469310776169E+01,
     &    0.882060325682313739E+00,
     &    0.154421828438037512E+01,
     &    0.221772893342173760E+00,
     &    0.308661695025961746E+00,
     &   -0.509110863609529701E-01,
     &    0.347692343552418071E+00,
     &   -0.105310103485996745E+00,
     &   -0.871011915793674651E+00,
     &    0.219122312487502108E+00,
     &   -0.934817655560147731E+00,
     &    0.252199276733235056E+00,
     &    0.201282877594887583E-01,
     &    0.314521329517344406E+00,
     &   -0.638845136039491379E+01,
     &   -0.466716686739705899E+01,
     &   -0.207502373428555948E+02,
     &    0.149407483304525823E+01,
     &   -0.652010458266027104E+01,
     &   -0.227683053921807721E+01,
     &    0.459574728942873367E+01,
     &    0.103347217720041074E+00,
     &    0.210415152699152230E+01,
     &   -0.194940528507641719E+01,
     &    0.110659056558003191E+00,
     &   -0.368387927164514850E+00,
     &   -0.497356947311105291E+01,
     &   -0.733579312820691332E+00,
     &    0.181583773431362672E+01,
     &    0.968661780237557757E+01,
     &    0.365838221994674528E+00,
     &   -0.532004359284759509E+01,
     &    0.169902737818469346E+00,
     &    0.426635031329224257E+00,
     &    0.133936219704641513E+01,
     &   -0.314524601853064870E-01,
     &    0.119991121052955729E+00,
     &   -0.159727427759295479E-01,
     &    0.384848115194041551E+00,
     &   -0.101747921954189066E+00,
     &    0.122178626737487056E+00,
     &    0.724646454621554192E+00,
     &   -0.591801423808372903E-01,
     &   -0.190632660581774027E-01,
     &   -0.421344713649754610E+01,
     &   -0.160255331252790900E+01,
     &    0.107378604015285939E+01,
     &   -0.265994425969440562E+00,
     &   -0.425019983047500050E+00,
     &   -0.570659826645087964E+00,
     &   -0.624070317735514357E+00,
     &   -0.302669867209672316E+00,
     &    0.677943584174919511E+00,
     &    0.167130195960871419E+00,
     &   -0.145283286780724619E+01,
     &   -0.316618101355624071E+00,
     &   -0.848975209664104447E+00,
     &   -0.178036860733415264E-01,
     &    0.269889475705349158E+00,
     &    0.114936439688343643E+02,
     &   -0.994215404197392044E-01,
     &   -0.139243289306276607E+01,
     &   -0.369352079201544448E+00,
     &    0.380990031869178791E+00,
     &    0.654752158671127238E+00,
     &    0.316416319596164397E+00,
     &    0.395398678415395333E+00,
     &   -0.666372476542407388E+00,
     &   -0.337137532060051315E+00,
     &    0.119584394907218616E+01,
     &   -0.286381526214330107E+00,
     &    0.606165479917343153E+00,
     &    0.249525791456435941E+00,
     &   -0.214195475627236120E+00,
     &   -0.206350242102819408E+02,
     &   -0.462354120290920712E+01,
     &   -0.202202282997631677E+02,
     &    0.148311121539882418E+01,
     &   -0.650499710096342731E+01,
     &   -0.228723239823500135E+01,
     &    0.443578121662825797E+01,
     &    0.822405293437471624E-01,
     &    0.208562876246402995E+01,
     &   -0.193016746685645213E+01,
     &    0.667699120261156381E-01,
     &   -0.344787297570494311E+00,
     &   -0.500673406213192074E+01,
     &   -0.757456169953515723E+00,
     &    0.180310475695892625E+01,
     &    0.970145297832877418E+01,
     &   -0.248579193970014032E+02,
     &    0.267929769046560828E+02,
     &    0.570976018201479789E+02,
     &    0.381993466845724186E+02,
     &    0.191081197328560677E+02,
     &    0.671654045039944094E+02,
     &   -0.811535388966847364E+02,
     &   -0.336671390462151479E+02,
     &   -0.160382974002385552E+02,
     &    0.150514470841415982E+02,
     &    0.824516494811039391E+00,
     &    0.348635869802321423E+02,
     &   -0.330815971926520624E+00,
     &   -0.142473675894574932E+02,
     &    0.189559054636060615E+02,
     &   -0.357616981047994287E+01,
     &   -0.180866303009594560E+02,
     &    0.594763160809563196E+01,
     &    0.395800177950051779E+01,
     &   -0.788900765838211715E+01,
     &   -0.256039696544297124E+01,
     &   -0.848341349521884425E+01,
     &   -0.276667740831567022E+01,
     &   -0.581726552403311015E+01,
     &   -0.327969634063382820E+01,
     &    0.780632075446424167E+01,
     &    0.362922431474686924E+01,
     &    0.767623623972987085E-01,
     &   -0.386183750105287427E+01,
     &   -0.368293954626573417E+01,
     &   -0.216262748555390782E+01,
     &   -0.109905179152628052E+01,
     &   -0.321004466812600198E+01,
     &    0.690097309861022246E+00,
     &    0.854526990227644445E+00,
     &   -0.428587117579768695E+00,
     &   -0.529357647594407843E+00,
     &   -0.189877026259942155E+00,
     &   -0.141819319873068905E+01,
     &   -0.134964640345740716E+01,
     &   -0.977951705653836378E+00,
     &    0.120774728463410774E+01,
     &   -0.248673943786032955E-01,
     &    0.369604436869114539E+00,
     &   -0.152104755128902234E+02,
     &   -0.324840135109478012E+00,
     &   -0.943391489980385578E+00,
     &   -0.494895180299272375E+00,
     &   -0.265669093430433600E+00,
     &   -0.204643754375034459E+00,
     &    0.820140902454267740E-01,
     &   -0.374297812966600363E+00,
     &    0.143092098347128077E+00,
     &   -0.357184648817233275E+00,
     &   -0.624530627140933658E+00,
     &    0.644100764699674228E-01,
     &   -0.239857147823589550E+00,
     &   -0.212558664820406334E+00,
     &   -0.233597789088043406E+00,
     &    0.655152470131573672E+01,
     &   -0.306904828796656020E+02,
     &   -0.117577459986801731E+02,
     &   -0.700384583089051826E+01,
     &    0.308044617464424562E+02,
     &    0.974884809496484728E+01,
     &   -0.394650550430872187E+02,
     &   -0.374550320424748406E+02,
     &   -0.174476912073941541E+02,
     &   -0.196103645255248722E+02,
     &   -0.225779106999989345E+02,
     &    0.143179436022909385E+02,
     &   -0.253673600199312332E+02,
     &    0.522995464030069890E+01,
     &   -0.647059197964988453E+01,
     &   -0.575386503038459107E+01,
     &    0.145363506474091064E+01,
     &   -0.161743832543225849E+02,
     &    0.227859922583637908E+00,
     &    0.521612022139215203E+00,
     &   -0.766718884038991888E+01,
     &   -0.111090105290346108E+01,
     &    0.838462656357126468E+00,
     &    0.222592536369013061E+01,
     &    0.466942240734863900E+00,
     &   -0.420593616160500527E+01,
     &    0.515777635777065502E+01,
     &    0.147272819951588985E+01,
     &   -0.242150340219395099E+01,
     &   -0.148752293459330076E+01,
     &    0.306668857457418405E+02,
     &    0.234659557258003204E+01,
     &    0.346625805275479806E+02,
     &    0.469750844605953455E+00,
     &   -0.163191813093683202E+01,
     &   -0.112888666573218122E+01,
     &    0.539045115303826350E+01,
     &    0.200276862327112060E+01,
     &   -0.191858996286971090E+00,
     &    0.163572512995991404E+01,
     &    0.329144640131023536E+01,
     &   -0.135780666902282077E+01,
     &   -0.853008999524485567E+01,
     &    0.742199416324594019E-01,
     &   -0.564063313680849499E+00,
     &    0.309977345781058062E+02
     & /
      	data(wl2(i),i=1,n)/
     &    0.100677038917459107E+02,
     &   -0.319725576621105745E+01,
     &   -0.486925067967831082E+00,
     &   -0.136271178381744047E+02,
     &   -0.129037455413635769E+02,
     &   -0.194377617278304027E+01,
     &   -0.321075591650917413E+01,
     &    0.138682708710192077E+02,
     &    0.114666452257418037E+02,
     &   -0.181820169237509646E+02,
     &   -0.790812774803436480E+00,
     &   -0.647464758104300842E+01,
     &    0.192531941973174803E+02,
     &    0.320217969803652941E-01,
     &   -0.193362814235949898E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.359749195172755236E+02,
     &   -0.111381625923734173E+02,
     &   -0.571939187223929668E+01,
     &   -0.361228540285847677E+01,
     &   -0.120980044959989730E+02,
     &    0.146703098956673514E+02,
     &   -0.229963814118666647E+02,
     &   -0.302187644978130265E+01,
     &   -0.791381922037090213E+01,
     &   -0.168050894811915192E+02,
     &   -0.151351352998691109E+02,
     &    0.598466898860888730E+01,
     &   -0.109535287956416596E+02,
     &    0.172897909010823057E+02,
     &    0.540055954134027800E+02
     & /
      	data b2 / 0.851003822833501467E+01/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end


      subroutine SH2PES_i_7(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &   -0.651677595607442495E+01,
     &    0.212475991574467837E+01,
     &   -0.155541673110740009E+01,
     &    0.182579890864585281E+01,
     &    0.235570164160015105E+01,
     &   -0.588069702701835340E+01,
     &   -0.429681824158266307E-01,
     &    0.162248922972187237E+00,
     &    0.135760904908263691E+01,
     &   -0.147248576537564606E+02,
     &    0.132121041173638059E+02,
     &    0.128885123585172146E+01,
     &    0.125806583199641497E+00,
     &   -0.424100547613509293E+00,
     &    0.335102550081342532E+01,
     &   -0.105346307710692830E+02,
     &    0.611414263395706925E+01,
     &   -0.764316039931443592E+00,
     &   -0.865402859570299476E+01,
     &    0.562682195149085196E+01,
     &    0.593949269338948871E+00,
     &    0.319523669282782263E+01,
     &    0.558103946912693882E-01,
     &    0.384599381540657981E+00,
     &   -0.436427120623144538E+00,
     &   -0.143753785615745233E+01,
     &    0.130266426679912772E+01,
     &   -0.607988824245182746E+00,
     &    0.229859895395884761E+01,
     &   -0.439569729539319942E+00,
     &    0.177429009562687506E+00,
     &   -0.772550233309353906E+00,
     &    0.421420781924024634E+01,
     &   -0.439254648624890986E+01,
     &    0.714882480209672533E+01,
     &   -0.783355266257995542E+01,
     &   -0.260068405408987768E+01,
     &    0.517730164384397784E+00,
     &    0.303903061390330764E+01,
     &    0.144829264570535465E+01,
     &   -0.632188392012460287E+01,
     &    0.930322784662773183E+00,
     &    0.601142632893369666E+00,
     &   -0.235563943026393918E+01,
     &   -0.884762989490951446E+00
     & /
      	data(bbi(i),i=1,m)/
     &    0.601078286090345237E+01,
     &   -0.455049031660612258E+01,
     &   -0.882210610173428611E+00,
     &    0.750315746545136175E+01,
     &   -0.230856767913742295E+00,
     &    0.653881564242947455E+01,
     &    0.308257514332568361E+01,
     &   -0.580776353824451808E+00,
     &    0.821599734385403013E+00,
     &    0.900160227074129349E+00,
     &   -0.160627435920595474E+01,
     &   -0.104506092149660779E+01,
     &   -0.339540024349997083E+00,
     &   -0.403082564622122863E+01,
     &   -0.318893660122252420E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.825279162861536797E+01,
     &   -0.501412464959613846E+01,
     &    0.409729968306796124E+02,
     &    0.358543816818928662E-01,
     &   -0.115125283608831008E+02,
     &   -0.998756273687399720E+00,
     &   -0.791927333762233565E+00,
     &   -0.777719298348536925E+00,
     &    0.397311036706163589E+01,
     &   -0.903798869122663828E+00,
     &    0.172047605200460052E+01,
     &    0.412990502832846010E-01,
     &    0.826812438216519618E+00,
     &    0.282166057858385277E+00,
     &    0.697546834079770584E+01,
     &    0.471970022080005935E+00,
     &   -0.469627643828975572E+01,
     &    0.295196822546312188E+00,
     &    0.249178086128992754E+00,
     &    0.309047943210183862E+00,
     &    0.100701262148304305E+01,
     &    0.535347225533122972E+00,
     &   -0.398939559916617281E+00,
     &    0.741018473207877393E+00,
     &    0.154098264056182588E+01,
     &   -0.136543128178244183E+00,
     &    0.185943732012093632E+00,
     &    0.307201251891930371E+00,
     &    0.274222431865524030E+00,
     &   -0.121284463211344686E+02,
     &    0.263401566015087152E+01,
     &    0.324805707449337167E+01,
     &    0.167223213272152127E+01,
     &    0.220990717004820370E+00,
     &    0.262563438420873208E+00,
     &   -0.271944465458030471E+00,
     &    0.347498582293886971E+00,
     &    0.524834167626090295E-01,
     &   -0.700125608656264720E+00,
     &    0.226752547848991966E-01,
     &   -0.879482227537855432E+00,
     &    0.248278030114754716E+00,
     &   -0.386191267215771489E-01,
     &    0.227988197275425047E+00,
     &   -0.114158405831956955E+02,
     &   -0.698516770924014807E+01,
     &   -0.543028946896040736E+02,
     &    0.171290508757197157E+01,
     &   -0.686435391747055768E+01,
     &   -0.218021999713575765E+01,
     &    0.934059638053743413E+01,
     &   -0.148109259858876602E+00,
     &    0.177569002078443194E+01,
     &   -0.158209260901937943E+01,
     &    0.449947587636518875E+00,
     &   -0.216101411045963754E+00,
     &   -0.397419761676462047E+01,
     &   -0.563988230581799921E+00,
     &    0.156326120122135936E+01,
     &    0.171182247974155146E+02,
     &    0.379899212617316684E+00,
     &   -0.131935152475522841E+02,
     &    0.187606597413669168E+00,
     &    0.439421787409870146E+00,
     &    0.145672943932813026E+01,
     &    0.149013659893787842E+00,
     &    0.161548085919152817E+00,
     &    0.141393290190390663E-01,
     &    0.298737532607262934E+00,
     &   -0.109126214009754308E+00,
     &    0.105709267258313838E+00,
     &    0.671979754620341541E+00,
     &   -0.851753536153037477E-01,
     &    0.508393231040041763E-04,
     &   -0.774883658117019536E+01,
     &   -0.174996059298033413E+01,
     &    0.286098872617677014E+01,
     &   -0.138427969896839698E+00,
     &   -0.469739116656141986E+00,
     &   -0.554382588132011689E+00,
     &   -0.162591130001485373E+01,
     &   -0.281417036149388622E+00,
     &    0.621206182392883832E+00,
     &    0.138170195294109815E+00,
     &   -0.145886454182264647E+01,
     &   -0.356189171716248310E+00,
     &   -0.934096836369447736E+00,
     &    0.148258086241116506E-01,
     &    0.115720040565020707E+00,
     &    0.243053197919812263E+02,
     &   -0.226099322646085094E+00,
     &   -0.377454610480439667E+01,
     &   -0.522845880065251012E+00,
     &    0.484790111127553602E+00,
     &    0.682324906145474808E+00,
     &    0.851402909260793206E+00,
     &    0.401365069383381901E+00,
     &   -0.610852264396852029E+00,
     &   -0.278788045723442179E+00,
     &    0.124519469606928168E+01,
     &   -0.256678758214854696E+00,
     &    0.780149019993726434E+00,
     &    0.357930822711320484E+00,
     &   -0.810132634883803937E-01,
     &   -0.422899775303685388E+02,
     &   -0.693940113739842079E+01,
     &   -0.530941245741706922E+02,
     &    0.171955783287596575E+01,
     &   -0.684600560506593769E+01,
     &   -0.219378407065410697E+01,
     &    0.910292258980454960E+01,
     &   -0.171434245779746058E+00,
     &    0.174579761496825658E+01,
     &   -0.157291928226218602E+01,
     &    0.419324218736719823E+00,
     &   -0.191918689206674931E+00,
     &   -0.403426232413239561E+01,
     &   -0.593036895903010230E+00,
     &    0.155316678890851767E+01,
     &    0.172087422327714279E+02,
     &   -0.363548352753845236E+02,
     &    0.529954076892613983E+02,
     &    0.849110285240167997E+02,
     &    0.405187447971119425E+02,
     &    0.156252677299648912E+02,
     &    0.170950470746555254E+03,
     &   -0.102064169166349032E+03,
     &   -0.399441216195447879E+02,
     &   -0.113115326283894468E+02,
     &    0.246847928561409944E+02,
     &    0.119914994465256219E+01,
     &    0.418685183712910742E+02,
     &   -0.153975569233545562E+01,
     &   -0.359638567584774123E+02,
     &    0.715143287707353181E+02,
     &   -0.387204455740417597E+01,
     &   -0.233736144123429774E+02,
     &    0.389123216100007863E+01,
     &    0.404737368505804795E+01,
     &   -0.724882584680801845E+01,
     &   -0.117011423163644217E+02,
     &   -0.687921231779812636E+01,
     &   -0.278210844148137371E+01,
     &   -0.474205219715042237E+01,
     &   -0.325299451386301453E+01,
     &    0.709687144816715865E+01,
     &    0.356524706933891133E+01,
     &    0.853230375761345083E+00,
     &   -0.721748532306612400E+00,
     &   -0.173259192419217563E+02,
     &   -0.207060065615822309E+01,
     &    0.100642623802371145E+01,
     &   -0.457401230168687345E+01,
     &    0.756574082544056781E+00,
     &    0.118131293248547431E+01,
     &   -0.157730012700201372E+01,
     &   -0.345659789969561815E+00,
     &    0.107658332139063215E+00,
     &   -0.127653454678039968E+01,
     &   -0.149539087253501379E+01,
     &   -0.677060446427410922E+00,
     &    0.103366560457282008E+01,
     &   -0.137694749706677694E+00,
     &    0.396724518701843054E+00,
     &   -0.283323197831288773E+02,
     &   -0.171705192727775985E+00,
     &   -0.402862595811965640E+01,
     &   -0.501483311815444477E+00,
     &   -0.248897934766905610E+00,
     &   -0.147296109285029841E+00,
     &    0.263379772885662777E+00,
     &   -0.423343720151052760E+00,
     &   -0.370100493178569887E-02,
     &   -0.273539322363535287E+00,
     &   -0.413184045820707058E+00,
     &    0.584062311196307318E-01,
     &   -0.183493318671000910E+00,
     &   -0.215980549184049408E+00,
     &   -0.162166264079867423E+00,
     &    0.116914318600378380E+02,
     &   -0.391798322451496475E+02,
     &    0.562818206920228281E+01,
     &   -0.644553013707420597E+01,
     &    0.348025250102962858E+02,
     &    0.146211513037505600E+02,
     &   -0.931620096508250839E+02,
     &   -0.414865309924659229E+02,
     &   -0.199217176194519254E+02,
     &   -0.138478745821126150E+02,
     &   -0.208631451366541008E+02,
     &    0.123364246565940849E+02,
     &   -0.150286885052886827E+02,
     &    0.626966295066295043E+01,
     &   -0.108697650608453156E+01,
     &   -0.625825815546540412E+02,
     &    0.948071225430725129E+01,
     &   -0.250161708051891729E+02,
     &    0.162493524830729186E+01,
     &    0.375554915843922921E+00,
     &   -0.838116001169705527E+01,
     &   -0.165219254571276597E+01,
     &    0.517841356205078540E+00,
     &    0.125433994014375849E+01,
     &    0.424744302426932008E+00,
     &   -0.274098253781020018E+01,
     &    0.522618619007306418E+01,
     &    0.131990656118653393E+01,
     &   -0.243564065185676437E+01,
     &   -0.104978837935588620E+01,
     &    0.465984424568485736E+02,
     &    0.282015284971946034E+01,
     &    0.525329373925557945E+02,
     &    0.396182173851073238E+00,
     &   -0.217226630266926524E+01,
     &   -0.439232718313769477E+00,
     &    0.135152204128648155E+02,
     &    0.227042937174126092E+01,
     &   -0.278502833021350815E+00,
     &    0.154072742465484347E+01,
     &    0.355166790837950153E+01,
     &   -0.167960294313713909E+01,
     &   -0.798776615595411688E+01,
     &    0.178670339056582861E+00,
     &   -0.810150644077235693E+00,
     &    0.518773188831028946E+02
     & /
      	data(wl2(i),i=1,n)/
     &    0.234218346067373453E+02,
     &   -0.227081163505429506E+01,
     &   -0.480781552262364908E+00,
     &   -0.144957531342470798E+02,
     &   -0.954800923939741786E+01,
     &   -0.166697239468445146E+01,
     &   -0.251320736585596327E+01,
     &    0.147312370653460452E+02,
     &    0.157746313255978823E+02,
     &   -0.314860573431996080E+02,
     &   -0.653180433572498553E+00,
     &   -0.521829562326790963E+01,
     &    0.323963795297751815E+02,
     &    0.278113155528110778E-01,
     &   -0.374432438354470278E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.269774248609491742E+02,
     &   -0.187346579627965006E+02,
     &   -0.890062574152115182E+01,
     &   -0.312078989678481840E+02,
     &   -0.237185691337980344E+02,
     &    0.304341546792258875E+02,
     &   -0.474387746098096059E+02,
     &   -0.297995914903452785E+02,
     &   -0.449010955024414997E+02,
     &   -0.254770119530327719E+02,
     &   -0.262430522751638726E+02,
     &    0.775441384020257907E+01,
     &    0.921584124067574884E+01,
     &    0.183071402548162006E+02,
     &    0.856666498325166827E+02
     & /
      	data b2 / 0.210102159529077248E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end

      subroutine SH2PES_i_8(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.399745033092365887E+01,
     &   -0.179705156529501231E+01,
     &    0.141470831434327127E+01,
     &   -0.497183022059835444E+01,
     &    0.323666699534982616E+01,
     &   -0.145008543172515547E+01,
     &    0.448721549330019176E+01,
     &   -0.263151617933397075E+01,
     &    0.140757455830312983E+01,
     &   -0.347984052893621953E+01,
     &    0.195615254759908797E+01,
     &    0.359235853431688046E+01,
     &    0.143427980371135444E+01,
     &    0.208311650791151681E+01,
     &   -0.119822713563391847E+01,
     &    0.903686478014241068E+01,
     &   -0.635508292602639813E+01,
     &   -0.209260169723510497E+00,
     &    0.983644842349641024E+01,
     &   -0.728237657284205131E+01,
     &   -0.954729291743119601E+00,
     &    0.104870423723866022E+02,
     &   -0.105786085677161168E+02,
     &    0.895383579322251544E+00,
     &    0.118391999905358958E+01,
     &   -0.144794322278535015E+01,
     &   -0.206302818699526505E+02,
     &    0.371542479135763815E+01,
     &   -0.272999662358572026E+01,
     &   -0.224966535356505082E+01,
     &    0.609988939721257228E+00,
     &   -0.353007592173791451E+01,
     &    0.498458660986902036E+01,
     &   -0.371898138782165333E+01,
     &    0.210276190180844091E+01,
     &    0.234576334265071162E+01,
     &    0.302870377916642264E+01,
     &   -0.100476391775744212E+01,
     &   -0.965582933284970579E+00,
     &    0.186624863031159383E+00,
     &    0.247953214024250634E+01,
     &   -0.290676833028441939E+00,
     &   -0.689118710807735546E+01,
     &    0.453258573898761519E+01,
     &   -0.886162380518207504E+00
     & /
      	data(bbi(i),i=1,m)/
     &   -0.362233470255845980E+01,
     &    0.206137463829295875E+01,
     &   -0.173201600134593203E+01,
     &    0.293465987804416439E+01,
     &    0.600598460496986203E-01,
     &   -0.340925469709520357E+01,
     &   -0.343121750538977954E+01,
     &   -0.500764879543621255E+01,
     &    0.171115928312090015E+01,
     &   -0.296238809430089711E+01,
     &    0.238861568092799592E+01,
     &   -0.618772463508377668E+00,
     &    0.103159893501756986E+00,
     &    0.172829072792468130E+01,
     &    0.141284735139913775E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.267266690086553282E+01,
     &    0.137562983929745748E+02,
     &    0.135857885864622645E+02,
     &    0.268164791928408208E+01,
     &   -0.151567180691981229E+01,
     &    0.395470422638015906E+01,
     &   -0.944419757317369823E+00,
     &   -0.497316889449003208E+00,
     &    0.256553086532852637E+00,
     &    0.161510821992880835E+02,
     &   -0.209631244585406762E+01,
     &   -0.147778562410988745E+00,
     &    0.466085002985168906E+01,
     &   -0.699368795166256429E+01,
     &   -0.831433162817154958E+00,
     &    0.540447495022392399E+01,
     &    0.190676223238977549E+01,
     &    0.245391639259722760E+01,
     &   -0.502089842149524657E+01,
     &   -0.458331149568291657E-01,
     &    0.962851822019830550E+00,
     &    0.259696906872585731E+00,
     &    0.998820641332081594E-01,
     &   -0.158278477469202650E+00,
     &   -0.117332857958919270E+02,
     &    0.837071526735397065E+01,
     &   -0.370546662392296033E+01,
     &   -0.674981873029964774E+01,
     &    0.159816658741128892E+01,
     &   -0.217007659164438582E+01,
     &   -0.382261298226574286E+01,
     &    0.169244692959899501E+01,
     &    0.318042393796691236E+01,
     &    0.603716185673429884E+00,
     &    0.653315727169403226E+00,
     &    0.401672806531286897E+00,
     &    0.364181125040112297E+00,
     &    0.370215274896752780E-01,
     &    0.249342731042977023E+00,
     &    0.188377754972559330E+01,
     &    0.134841477058801673E+01,
     &    0.211173257369067890E+01,
     &    0.271094360693562431E+01,
     &   -0.598048335588535984E+01,
     &   -0.124304595342851809E+01,
     &   -0.316309388529081481E+02,
     &    0.507418414056235747E+02,
     &    0.837533167553041551E+02,
     &   -0.133842199479415598E+03,
     &   -0.706700840676994204E+02,
     &   -0.817212080376703227E+02,
     &    0.441665221694179380E+02,
     &   -0.481973661790677568E+02,
     &    0.134949319393650669E+02,
     &   -0.130936074447916553E+03,
     &   -0.262781327934079867E+01,
     &    0.329787310897298340E+02,
     &    0.848764539101485695E+02,
     &   -0.306511753240140905E+02,
     &   -0.172015338593742854E+03,
     &    0.334272271170058843E+01,
     &    0.346188079671888804E+01,
     &    0.411801370090920837E+01,
     &   -0.273156462806266465E+01,
     &   -0.860916461273890099E-01,
     &    0.831229357222261211E+00,
     &    0.539368038286454493E-01,
     &    0.370972964004626718E-01,
     &    0.512994042672813011E-01,
     &   -0.447027482872533177E+01,
     &    0.875195636552598799E+00,
     &   -0.345121375388606211E+01,
     &   -0.665905200009642950E+01,
     &    0.184664516985958826E+01,
     &   -0.204586431289744652E+01,
     &   -0.141755742552183392E+03,
     &   -0.588142513038632799E+02,
     &   -0.171346817078738383E+03,
     &   -0.478281219970126941E+02,
     &    0.124412477839496605E+01,
     &    0.145698063125551300E+02,
     &   -0.397278059009292832E+02,
     &   -0.428153813781594650E+01,
     &   -0.108795093290301956E+02,
     &   -0.751002447226291565E+02,
     &   -0.253922197364412128E+02,
     &    0.950559839406143681E+02,
     &    0.129644880259487053E+03,
     &    0.307700984416748859E+02,
     &   -0.600263262376371145E+02,
     &    0.268371259803945494E+00,
     &   -0.303997069870548309E+01,
     &   -0.273155980202354698E+01,
     &   -0.873452575234722417E+01,
     &   -0.149024019686893272E+01,
     &   -0.352594165894375289E+01,
     &    0.635638462119269665E+00,
     &    0.363002017338378280E+00,
     &    0.604141998919033793E-01,
     &   -0.176836337417591061E+02,
     &    0.601006414075953010E+01,
     &    0.573611753997184670E+00,
     &    0.119136997666106392E+01,
     &    0.244500746835367400E+01,
     &    0.120393054221240448E+01,
     &   -0.137469882327646054E+01,
     &    0.577577181523970573E+01,
     &    0.541882363266669831E+01,
     &    0.152775735067097096E+01,
     &   -0.626640054133855567E-01,
     &    0.155296137578182569E+01,
     &   -0.689234786055413218E+00,
     &    0.174987103216542761E+00,
     &    0.429783637078362951E-01,
     &    0.458779453704866924E+01,
     &    0.514542313163440390E+01,
     &    0.661195037210328573E+00,
     &   -0.593233282448116100E-01,
     &   -0.191424740119328951E+01,
     &    0.672609507876159807E+00,
     &   -0.519466709883335542E-01,
     &    0.709710568214271120E+01,
     &    0.705067188883820162E+01,
     &    0.458861253654456558E+01,
     &    0.360360552538546777E-01,
     &    0.108519231862964438E+01,
     &    0.481208430072949001E+00,
     &    0.972948561873975964E-01,
     &   -0.143607768529382205E-01,
     &    0.106949997103360506E+02,
     &    0.192140253083562662E+01,
     &    0.451091450754924295E+00,
     &   -0.161031993555515007E+00,
     &   -0.268329515427319221E+01,
     &    0.159438644835321663E+01,
     &   -0.401643457223850575E+01,
     &   -0.130738649711523447E+02,
     &   -0.134068900282896131E+02,
     &   -0.399409165603886229E+00,
     &    0.259910800047845336E+00,
     &    0.152364810502273862E+01,
     &   -0.152919805937549502E+01,
     &   -0.636776213642813518E-02,
     &   -0.605356585279047121E-01,
     &   -0.336390951599645582E+01,
     &    0.844245672307452821E+02,
     &    0.322799252965860928E+00,
     &   -0.244724129934729762E+01,
     &    0.367900613467932569E+01,
     &   -0.652565111363442640E+00,
     &   -0.124358259760460721E+00,
     &   -0.465956749735543951E+01,
     &   -0.460280551486972911E+01,
     &   -0.133520343254266138E+01,
     &    0.154113767618104025E+00,
     &   -0.304240428409718877E+00,
     &   -0.467439959549189488E+00,
     &   -0.270023106411355282E-01,
     &   -0.746971049330089759E-01,
     &   -0.425261506692901747E+01,
     &   -0.819348258877260593E+00,
     &   -0.836239090138962554E-01,
     &   -0.197496722558208671E+01,
     &    0.269772425957536521E+01,
     &    0.273675850854721237E+00,
     &    0.756025629077897832E+00,
     &   -0.572317771100345407E+01,
     &   -0.533518844903542000E+01,
     &   -0.107295005282865796E+01,
     &    0.155052945491560318E+00,
     &   -0.155029433668014538E+01,
     &    0.616354199502151756E+00,
     &   -0.165240948727885251E+00,
     &   -0.339334380872087019E-01,
     &   -0.376683243354646402E+01,
     &   -0.460941580520507177E+01,
     &   -0.539970689907774193E+00,
     &   -0.536938515301483399E+00,
     &    0.231755564190900776E+01,
     &   -0.483149434275293110E+00,
     &    0.569735822463413380E-01,
     &    0.468345432170046116E+01,
     &    0.461857328830375025E+01,
     &    0.140085528366277945E+01,
     &   -0.130176641447173280E+00,
     &    0.267153883662209157E+00,
     &    0.520713348221010563E+00,
     &    0.165452019141094399E-01,
     &    0.728525603590731013E-01,
     &    0.436676914109357650E+01,
     &    0.758018762355124553E+00,
     &    0.662010782330597486E-01,
     &    0.189405994644049769E+01,
     &   -0.267004445956701719E+01,
     &   -0.288620839753426506E+00,
     &   -0.199186474323539997E+02,
     &   -0.591193404873518524E+01,
     &   -0.417748158620397003E+01,
     &    0.458638506820470226E+01,
     &   -0.628838666179333039E+00,
     &    0.236156375764103379E-01,
     &   -0.330258906623589743E+01,
     &   -0.711185347853778294E+00,
     &   -0.350862731267984618E-01,
     &    0.901001571853920247E+01,
     &    0.429976736397170356E+01,
     &    0.147012684588869735E+02,
     &    0.265628942089866875E+02,
     &   -0.107958811118227711E+02,
     &    0.413060813496609214E+01,
     &   -0.191163003024305844E+02,
     &   -0.526856531665129690E+01,
     &   -0.354022852418677259E+01,
     &    0.192193459260694866E+01,
     &   -0.653269272772552090E+00,
     &   -0.112403102756976694E+00,
     &   -0.310332718936836383E+01,
     &   -0.705242870076203898E+00,
     &   -0.370103047311295535E-01,
     &    0.797579448715407224E+01,
     &    0.539678738816122561E+01,
     &    0.145202582153887700E+02,
     &    0.261789766950002445E+02,
     &   -0.107101772779371363E+02,
     &    0.406871424116905800E+01
     & /
      	data(wl2(i),i=1,n)/
     &    0.265710455372109577E+00,
     &    0.948057595663268193E+00,
     &    0.403972239083563380E+02,
     &    0.520445439800115395E+02,
     &   -0.151950939550057984E+01,
     &   -0.453060907124854779E+02,
     &   -0.202096119392628886E+02,
     &    0.514691548619578487E+01,
     &    0.197920017492490996E+01,
     &   -0.400496858762636132E+00,
     &   -0.317626091123433767E+02,
     &    0.755802457799989202E+01,
     &   -0.325502988572425096E+02,
     &   -0.733320942361859665E+02,
     &    0.972670118527780261E+02
     & /
      	data(b1(i),i=1,n)/
     &    0.189014155436974427E+02,
     &   -0.131704910303170362E+02,
     &    0.325102806709486103E+01,
     &   -0.223311444199883340E+03,
     &   -0.277140862106519048E+01,
     &   -0.133217519587548793E+03,
     &   -0.196920762090002519E+02,
     &   -0.412122696646127828E+00,
     &    0.766950397897003011E+01,
     &   -0.924135753550032604E+02,
     &   -0.231692877062340719E+01,
     &    0.873603073178531447E-01,
     &    0.237836805695554121E+01,
     &   -0.780021767001161503E+01,
     &   -0.649333031926287418E+01
     & /
      	data b2 / 0.119386554681722572E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end


      subroutine SH2PES_i_9(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 15,n= 15)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2,swifun
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.260551636287579402E+01,
     &   -0.769888289266390635E+00,
     &    0.183077978430816607E+00,
     &   -0.124356081484326308E+01,
     &    0.295731568287765212E+01,
     &    0.124255198885406148E+01,
     &   -0.430406095157175628E+01,
     &    0.130924689537054584E+01,
     &    0.542916141426214360E+00,
     &   -0.192887162588972783E+01,
     &    0.136688197110534371E+01,
     &   -0.124053861755926906E+02,
     &    0.182048869421244213E+02,
     &   -0.159735169702057291E+02,
     &   -0.137971002876423898E+01,
     &   -0.222364801876871088E+01,
     &    0.189740624370104749E+01,
     &   -0.136593227895022840E+01,
     &   -0.519322225982653332E-01,
     &    0.162859222439609397E+01,
     &    0.660005294384448771E+00,
     &    0.381285862617335125E+01,
     &   -0.167538250612442741E+01,
     &   -0.489013758267455412E+00,
     &    0.364138600364616483E+00,
     &    0.574044469755373576E+01,
     &   -0.123177357596730523E+02,
     &   -0.304595085077468397E+01,
     &    0.149282294814076066E+01,
     &    0.207072967035533173E+01,
     &   -0.147996934360343180E+01,
     &    0.160886235997519567E+01,
     &   -0.149462232214268065E+01,
     &   -0.537249469016232961E+01,
     &    0.370808990049820641E+01,
     &    0.782554620878209151E+00,
     &   -0.443281604136080087E+01,
     &    0.171406049285592443E+01,
     &   -0.628898534900903639E+00,
     &   -0.731160934318710654E+00,
     &   -0.192824533034213186E+01,
     &    0.274708133301237911E+01,
     &    0.171391049232829018E+01,
     &   -0.503061515927358371E+01,
     &    0.379520911592843846E+00
     & /
      	data(bbi(i),i=1,m)/
     &   -0.159123271904955144E+01,
     &    0.291364822786815925E+01,
     &    0.237894513819794984E+01,
     &    0.190246675263806919E+01,
     &   -0.901264401520655767E+01,
     &    0.526461481389300268E+00,
     &   -0.533223599832245987E+00,
     &   -0.114385293432693524E+01,
     &   -0.508368513757031870E+01,
     &   -0.371008210451353959E+00,
     &    0.141694675238489709E+01,
     &    0.107051359112072109E+01,
     &    0.373079391010829342E+01,
     &   -0.274054615105547272E+01,
     &   -0.316033923163332098E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.561504215596917700E+01,
     &    0.656268085742168683E+01,
     &    0.141074316514642906E+01,
     &   -0.464628399113321655E+00,
     &   -0.427377387452276825E+00,
     &    0.626160106312415032E+00,
     &   -0.791025734065242569E+00,
     &   -0.218424619289594579E+01,
     &   -0.649881394982556149E+00,
     &   -0.973028991415065714E+00,
     &    0.785039703848595782E+00,
     &    0.156100815157583162E+01,
     &    0.389227199079643738E+01,
     &    0.688230837555805719E+00,
     &    0.533378422619668058E-01,
     &    0.551362461385235747E+01,
     &    0.670780329597992431E+01,
     &    0.136938635972441447E+01,
     &   -0.455343461332738397E+00,
     &   -0.424148932605606488E+00,
     &    0.495148425709023787E+00,
     &   -0.738298768576849285E+00,
     &   -0.223199204483216773E+01,
     &   -0.154336637837893448E+00,
     &   -0.773210077593044387E+00,
     &    0.988398809723949889E+00,
     &    0.150309825852668455E+01,
     &    0.381858240087915668E+01,
     &    0.592675385596581505E+00,
     &    0.499717837673408632E-01,
     &   -0.790877429993099934E+01,
     &   -0.295124290629331387E+01,
     &   -0.214609115788077798E+01,
     &   -0.110383430494588597E-01,
     &    0.245808127870286303E+00,
     &   -0.240173952258676637E+01,
     &    0.136227129411359882E+01,
     &    0.232660624514886960E+01,
     &    0.280874593357046343E+00,
     &    0.754849835247026202E+00,
     &    0.435606113863521605E+00,
     &    0.165647186999886809E+01,
     &    0.109424946083650809E+01,
     &   -0.155677443503243917E+00,
     &    0.207498829941520047E+01,
     &    0.158005288824825811E+02,
     &    0.168531628725326890E+02,
     &    0.551909022861087877E+02,
     &   -0.162081493511707038E+02,
     &    0.205501890081563907E+02,
     &    0.693584510550302866E+02,
     &    0.190458658332450916E+02,
     &    0.200910337659148084E+02,
     &    0.179043465368539607E+02,
     &    0.483878873678298618E+02,
     &    0.765441541329452946E+02,
     &    0.316499212450255314E+02,
     &    0.892270499751517860E+02,
     &    0.302896920738566822E+01,
     &   -0.204351682492692568E+02,
     &    0.639302662946494071E+00,
     &    0.608695932056133771E+01,
     &   -0.120890870966394481E+01,
     &   -0.608884774477939872E+00,
     &   -0.558785959543277255E+00,
     &    0.147742426265634302E+00,
     &   -0.994564567660289750E-01,
     &   -0.192896337082828762E+01,
     &   -0.156246728261472545E+01,
     &    0.218426425635376065E+01,
     &    0.250104722385196343E+01,
     &    0.472935888241980296E+00,
     &    0.378866095556939042E+01,
     &   -0.850743533103419436E+00,
     &   -0.160027382786537747E+00,
     &    0.407750470718175162E+01,
     &   -0.611379538587159033E+01,
     &    0.876503175102138044E+00,
     &    0.419187866900866568E+00,
     &    0.557873026360286350E+00,
     &   -0.338487423718412606E+01,
     &   -0.878568082063967082E+00,
     &    0.275593998049871558E+00,
     &   -0.549019925626450633E+00,
     &    0.167588661089779900E+01,
     &    0.326736664291464463E+01,
     &   -0.204436172086798695E+01,
     &    0.665963304864617966E+00,
     &   -0.379206606078349218E+00,
     &    0.247842374021241402E+00,
     &   -0.286897313265521703E+01,
     &   -0.452860420197773195E+01,
     &   -0.522147803168464542E+00,
     &   -0.192855234439036821E+00,
     &    0.197708386667902775E+00,
     &    0.582803331719001005E+00,
     &    0.354294403170339056E+00,
     &    0.207996361158894594E+01,
     &   -0.144497338913020412E+01,
     &    0.356615301791369965E+00,
     &    0.110225813321288379E+01,
     &    0.645633530162887714E+00,
     &    0.379920592255052314E+00,
     &    0.111258497320017002E+01,
     &    0.323258772064043964E+00,
     &   -0.398966235851018780E+01,
     &   -0.702277302272500314E+01,
     &   -0.508774262436913594E+00,
     &    0.467662148616157347E+00,
     &    0.464725649874507540E+00,
     &   -0.236902545345481941E+00,
     &    0.445733346989333423E+00,
     &    0.241593577480474186E+01,
     &   -0.133785228317858795E+01,
     &   -0.677674006988373656E+00,
     &   -0.184628175841538811E+01,
     &   -0.919118139349239360E+00,
     &   -0.352580645089229394E+01,
     &    0.265027277123269060E-01,
     &    0.333628506112632270E-01,
     &   -0.605707628367694326E+02,
     &   -0.172486896243769081E+02,
     &   -0.257916884787003013E+02,
     &   -0.420553403116089741E+00,
     &   -0.215698573566763052E+02,
     &   -0.933682015732890314E+01,
     &    0.142810352148634063E+02,
     &    0.512840077436183392E+02,
     &    0.410669269986502741E+02,
     &   -0.916681458812806227E+01,
     &   -0.276652653802650157E+02,
     &    0.239692977042996702E+02,
     &    0.106916683977260298E+02,
     &    0.991275540399830213E+01,
     &   -0.557340314695429129E+02,
     &   -0.526485203306736427E+01,
     &    0.642062110334469693E+01,
     &   -0.274799066886025400E+01,
     &   -0.114197006518322008E+01,
     &    0.298027537423352307E+00,
     &   -0.217008557651518919E+01,
     &    0.502569785815575654E+00,
     &   -0.627669046131617892E+00,
     &    0.151760471754794724E+01,
     &    0.521766267943374551E+00,
     &    0.165824923937290269E+01,
     &    0.218198015468841966E+01,
     &   -0.243529675146394942E+01,
     &   -0.184181620691837233E+01,
     &    0.231781050185277324E-01,
     &   -0.497029230938449107E+01,
     &   -0.354526049618735550E+01,
     &   -0.192910505656958131E+01,
     &   -0.245558598337346529E+00,
     &    0.248114128118932464E+00,
     &   -0.161959857186379591E+00,
     &    0.159708470034421190E+01,
     &    0.215432542798129267E+01,
     &   -0.779526315052287089E+00,
     &    0.194256927635347498E+01,
     &    0.233772356797501768E+01,
     &    0.691685947959340575E+00,
     &    0.278308996883152027E+01,
     &   -0.476154134339300816E+00,
     &    0.382334286585717609E+00,
     &   -0.422179802132627735E+01,
     &    0.130693472276784171E+02,
     &   -0.273297990348351894E+01,
     &   -0.352264458559597593E+00,
     &   -0.104538233832450462E+02,
     &   -0.209314814266185278E+01,
     &    0.324279616470384680E+01,
     &   -0.477590754303689913E+01,
     &    0.118814640798580609E+02,
     &   -0.348532773742183943E+00,
     &    0.683386690334578550E+00,
     &    0.375787556595679306E+00,
     &    0.327686279478716713E+01,
     &   -0.193981323912085046E+01,
     &   -0.273350192584756790E+01,
     &   -0.509724270419730452E+00,
     &    0.690975037958636129E+01,
     &   -0.185735398018084807E+01,
     &   -0.754091876755272200E-01,
     &   -0.476014039863709937E+00,
     &    0.546616663518217560E+01,
     &   -0.400505019018298714E+00,
     &   -0.234076585561006606E+00,
     &    0.595267109527781391E+00,
     &   -0.489732497774093734E+01,
     &   -0.824764290996719041E+01,
     &   -0.552901081819558549E+00,
     &   -0.609293608675372145E+01,
     &    0.570761516184858375E+00,
     &    0.339490045810308227E+00,
     &    0.371372725785700419E+01,
     &   -0.131684627396748759E+02,
     &    0.291793973176518007E+01,
     &    0.320207089932755151E+00,
     &    0.104762355321843970E+02,
     &    0.261858725171695417E+01,
     &   -0.284243908640533682E+01,
     &    0.490645646913412747E+01,
     &   -0.123627108471709040E+02,
     &    0.262033750492870032E+00,
     &   -0.105532886785454583E+01,
     &   -0.102132930522413345E+01,
     &   -0.300403276092370719E+01,
     &    0.203561440262997584E+01,
     &    0.329837759811865805E+01,
     &   -0.567958465377417343E+00,
     &   -0.647595660343659230E+01,
     &    0.143948266167453442E+01,
     &    0.591446434084533582E-01,
     &    0.432542290987011580E+00,
     &   -0.516087464072391722E+01,
     &    0.542359978992123071E+00,
     &    0.756386696149423776E+00,
     &   -0.342609327532297114E+00,
     &    0.449218351160876583E+01,
     &    0.742281806963199386E+01,
     &    0.675920128343047932E+00,
     &    0.545771548251342065E+01,
     &   -0.552392579276422713E+00,
     &   -0.261007117228734653E+00
     & /
      	data(wl2(i),i=1,n)/
     &    0.231541642187796164E+02,
     &   -0.278535663285308956E+02,
     &    0.178990261057514566E+02,
     &   -0.238438716158984256E+02,
     &   -0.219824734343897310E+01,
     &    0.438917490419185374E+00,
     &   -0.117773625993780606E+01,
     &   -0.740209035110794300E+01,
     &    0.663368366963955847E+01,
     &   -0.663571574376660145E-01,
     &    0.222302370252320269E+01,
     &   -0.193883374274744091E+01,
     &   -0.225847362409218952E+02,
     &   -0.172503581230033443E+01,
     &   -0.305025643341644503E+02
     & /
      	data(b1(i),i=1,n)/
     &   -0.850315439968503561E+01,
     &   -0.821050029777975432E+01,
     &    0.452758605674898718E+01,
     &   -0.125146839209195360E+02,
     &   -0.108769936468380610E+02,
     &    0.367184259115825995E+01,
     &    0.399002691851428803E+01,
     &    0.744242816747221969E+01,
     &   -0.402569663448471928E+02,
     &   -0.440751724570605941E+01,
     &    0.136276443487891252E+01,
     &   -0.194756622016118044E+02,
     &    0.111050906087951451E+01,
     &    0.191421181675131820E+02,
     &   -0.698632596471633560E+00
     & /
      	data b2 / 0.183842878500773601E+02/
      	data(xmin(i),i=1,3)/
     &    0.206518068354535813E-02,
     &    0.408877967663878831E-05,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.753638853392128438E+00,
     &    0.567971521342202079E+00,
     &    0.877335329448824863E+00
     & /
      ymini=-0.252763478492821769E-01
      ymaxi= 0.316709846321586663E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=29.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot
c       write(*,*)vtot-v2tot
         end


***************************************************************************************************

      subroutine SH2_other_part(r,Vtot_o)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
      	dimension r(3)
      call AB2PES_o_1(r,Vtot_o_1)
      call AB2PES_o_2(r,Vtot_o_2)
      call AB2PES_o_3(r,Vtot_o_3)
      call AB2PES_o_4(r,Vtot_o_4)

      Vtot_o=(Vtot_o_1+Vtot_o_2+Vtot_o_3+Vtot_o_4)/4.0
      end


      subroutine AB2PES_o_1(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 10,n= 10)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.559442411965653097E+01,
     &   -0.234349149270613077E+01,
     &   -0.707038714521347842E-02,
     &   -0.153957423619166089E+00,
     &   -0.257059294023612628E+01,
     &    0.495898913707385791E+01,
     &    0.156616015597815822E+00,
     &   -0.110099488622321481E+00,
     &    0.107476761223598700E+02,
     &    0.240476790651327743E+01,
     &   -0.489600677950878271E+01,
     &    0.123788941924578921E+01,
     &   -0.125012361699390007E+00,
     &    0.171424192420662602E+01,
     &    0.964344537506557631E-01,
     &   -0.472580017435593103E+01,
     &    0.247516555724142728E+01,
     &   -0.189962737774623847E+01,
     &    0.307440029042217544E+01,
     &    0.265271191841468856E+00,
     &    0.136614116179133016E+01,
     &    0.559613738298274654E+01,
     &   -0.289027061212999392E+01,
     &   -0.383247023803547382E+01,
     &    0.155768185492148714E+00,
     &   -0.184269536337533890E+01,
     &   -0.508666177446383028E+01,
     &    0.294907494169481366E+01,
     &   -0.100171665535652799E+01,
     &   -0.859618401457835191E+00
     & /
      	data(bbi(i),i=1,m)/
     &   -0.284645027799087469E+01,
     &    0.428459125405774977E+01,
     &   -0.433440363175541066E+01,
     &   -0.257267781062622136E+01,
     &    0.143372709840068779E+00,
     &    0.192616699614182463E+01,
     &    0.211054998836762236E+00,
     &   -0.374889382549119798E+00,
     &    0.663036076503159499E+01,
     &   -0.235529462772029774E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.911425334797509978E+00,
     &   -0.935479466346542665E+00,
     &   -0.653674749998545274E-01,
     &    0.267294670645402466E+00,
     &   -0.425148895676120731E+01,
     &   -0.123194941149336512E+01,
     &    0.104322606153972997E+01,
     &   -0.251478272015664750E+00,
     &   -0.302146404746824482E+01,
     &   -0.200357350008550927E+01,
     &    0.644183376323760881E-01,
     &    0.453487192743812084E+01,
     &   -0.117261563569073228E+02,
     &    0.929365204789935562E+00,
     &    0.205419484380701983E+00,
     &   -0.665910751373076248E+01,
     &   -0.522146296286649747E+01,
     &    0.308809589839426080E+01,
     &    0.103930310638920886E+01,
     &   -0.102970619930520702E+01,
     &   -0.234953378559018855E+01,
     &    0.248906492403920732E+01,
     &   -0.241076804135181311E+01,
     &   -0.279252563323451219E+00,
     &    0.642658131620110873E+00,
     &   -0.271797597531249258E+01,
     &   -0.368491076587359023E+01,
     &    0.685334365472725859E+00,
     &    0.113089930561746677E+01,
     &    0.324859929724218333E+01,
     &   -0.292614964666650179E+01,
     &   -0.181367523005975051E+01,
     &    0.165676525125014157E+00,
     &   -0.200965728714927391E-01,
     &    0.201272853204701629E+01,
     &   -0.100096955600619686E+01,
     &    0.669134543205793575E+00,
     &   -0.314861025085516277E+00,
     &   -0.194691370942672415E+01,
     &    0.641418813267746746E+00,
     &   -0.246118102825113594E+01,
     &   -0.134313549692575651E+01,
     &   -0.855634960626042995E-01,
     &   -0.122301481267222778E+01,
     &    0.297728646849798606E+01,
     &   -0.189766488123009203E+01,
     &   -0.189913599530957966E+01,
     &   -0.422361972450837786E+00,
     &   -0.585749685322888736E+00,
     &    0.309777351068344542E+01,
     &    0.570395117995936385E+01,
     &    0.347527958256399039E+01,
     &   -0.356100487940122479E+01,
     &   -0.151577358707393639E+00,
     &   -0.358299004249933883E+01,
     &   -0.303200892088397866E+01,
     &   -0.357848152439201916E+01,
     &    0.100390277944173256E+01,
     &   -0.119272074426697405E+01,
     &   -0.604016305583971036E+01,
     &    0.542684296566394764E+01,
     &    0.227905202202068358E+01,
     &   -0.419260732691130489E+01,
     &    0.490315144215586696E+00,
     &   -0.294823471689039440E+01,
     &    0.122140893282386472E-01,
     &    0.386440105225938468E+00,
     &    0.190050588215728844E+01,
     &    0.132088403344064820E+01,
     &   -0.230488082091906321E+01,
     &   -0.355173814429178725E+01,
     &    0.108103870759425114E+01,
     &    0.186013910998746063E+00,
     &    0.259131715528016400E-01,
     &    0.227273175277510564E+01,
     &   -0.102170671531831347E+01,
     &    0.663245586803850484E+00,
     &   -0.311932119834734456E+00,
     &   -0.252950678039811994E+01,
     &    0.204438809906365959E+01,
     &   -0.117561022204481191E+01,
     &   -0.447249228222906048E+01,
     &    0.179848535356484263E+00,
     &   -0.135273435300748458E-01,
     &    0.101125907840646700E+01,
     &   -0.153042716226565689E+01,
     &    0.501943314397530038E+00,
     &    0.788446640078055289E-01,
     &   -0.927005021933841045E+00,
     &   -0.244565307964389733E+01,
     &   -0.925543570872605059E+01,
     &   -0.563911926760095206E+01,
     &    0.468071496576724366E-01,
     &    0.595122901446283992E+00,
     &    0.561407880650169400E+01,
     &   -0.381582388204848522E+00,
     &    0.406645922993071363E+01,
     &    0.809714275298259345E+00,
     &   -0.153195941118301437E+01,
     &    0.122977461814330846E+01
     & /
      	data(wl2(i),i=1,n)/
     &   -0.428015799646169481E-01,
     &    0.954671587160517143E-01,
     &   -0.140428005145385204E+01,
     &    0.466843362022230401E+01,
     &   -0.277369193393695612E+01,
     &    0.486180930603827000E+00,
     &   -0.996531393806884130E-01,
     &   -0.346482752384478587E+01,
     &   -0.151133081085220722E+01,
     &    0.512418528474679746E+01
     & /
      	data(b1(i),i=1,n)/
     &   -0.293488013206870235E+01,
     &    0.660546021335440514E+01,
     &    0.308880853238241260E+01,
     &    0.104982183658536887E+01,
     &   -0.284479250374533199E+00,
     &    0.770554317646779507E+00,
     &    0.155108966852003882E+01,
     &   -0.235249717183132062E+00,
     &    0.238481374822916037E+00,
     &   -0.405524844025598785E+01
     & /
      	data b2 / 0.216131623698115893E+01/
      	data(xmin(i),i=1,3)/
     &    0.140843083064814945E-02,
     &    0.219565773025097817E-06,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.496018527065587633E+00,
     &    0.246034379192315078E+00,
     &    0.669702295779823986E+00
     & /
      ymini=-0.113828903354402655E-01
      ymaxi= 0.839796744337549805E-01
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=28.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot

         end

      subroutine AB2PES_o_2(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 10,n= 10)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.408094515824971804E+01,
     &   -0.267365165968076246E+01,
     &    0.224816467381790774E+01,
     &   -0.236799229852632509E+01,
     &    0.234002234129514708E+01,
     &   -0.391706632223111884E+01,
     &   -0.318191111288507145E+01,
     &    0.177058362803840330E+01,
     &    0.336225336661113539E+00,
     &    0.563705095574522463E+01,
     &   -0.260743100387122961E+01,
     &    0.289360116205136353E+00,
     &    0.135001705309065967E+01,
     &   -0.119239654127619416E+00,
     &    0.877471127190983413E+00,
     &    0.128257072552907503E+01,
     &   -0.298274939755069379E+01,
     &    0.698334488112882901E+00,
     &   -0.300156252251464473E+00,
     &    0.330420001192727020E+00,
     &    0.578796303695956116E+01,
     &    0.186701273690898684E+01,
     &   -0.301450768872784047E+00,
     &   -0.336996130850747466E+01,
     &    0.411169014830530255E+01,
     &   -0.203566496800586894E+01,
     &   -0.471376718030053599E+00,
     &    0.175471678867223257E+01,
     &   -0.483705316777351957E+00,
     &   -0.164982134223153443E+01
     & /
      	data(bbi(i),i=1,m)/
     &   -0.294283595437914869E+01,
     &   -0.129557737225979208E+01,
     &    0.107591310856312883E+01,
     &   -0.215570457940344573E+01,
     &    0.615217800054654762E+00,
     &   -0.103405603967298321E+01,
     &   -0.244357252479816411E+01,
     &    0.119448089319812389E+01,
     &   -0.622312012884184029E+00,
     &    0.156444910274185789E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.142059044561816838E+00,
     &    0.325463340122979217E+01,
     &    0.541885332868649705E+01,
     &   -0.616635224099711499E+00,
     &    0.106082295700507139E+02,
     &   -0.156435495695742555E-01,
     &    0.380680182060410821E+00,
     &    0.324311334747567404E+00,
     &    0.572247927332856232E+01,
     &   -0.586122715334174593E+00,
     &   -0.122506046044539274E+01,
     &   -0.179464281134316006E+01,
     &   -0.195546411008846999E+01,
     &    0.654247465125537331E+00,
     &   -0.475865687626464862E+01,
     &    0.567214393666691019E+00,
     &    0.118100390369383093E+00,
     &    0.116827257686864458E-01,
     &   -0.155236089666704791E+01,
     &   -0.111987419246985587E+01,
     &   -0.661984118025213775E+01,
     &   -0.166816371555406162E+01,
     &    0.123595340303547885E+01,
     &   -0.622320512823285155E+00,
     &    0.885997603620183760E+01,
     &   -0.574774682634411449E+00,
     &    0.282863463789810732E+01,
     &   -0.352384580887970378E+01,
     &    0.489816456550218948E+01,
     &   -0.608277405144785988E+01,
     &   -0.334337808528148206E+00,
     &   -0.298557915219088343E+01,
     &   -0.411033752393274643E+01,
     &    0.137277573850948653E+01,
     &   -0.108441357783034675E+02,
     &    0.951621549649982468E-01,
     &   -0.453031645635700697E+00,
     &   -0.103754458523312137E+00,
     &   -0.666488197617948952E+01,
     &    0.882253558309141428E+00,
     &    0.115980234516514269E+01,
     &   -0.128367710039264402E+02,
     &    0.106711037784730678E+01,
     &   -0.626673055096314768E+00,
     &    0.561229848363894579E+01,
     &    0.353845219643505626E+00,
     &    0.761557697279747980E+00,
     &    0.124146351287143086E+01,
     &    0.806833153403100578E+00,
     &   -0.521484303951442474E+01,
     &    0.649945737186242756E+01,
     &   -0.131964574286224612E+01,
     &   -0.157174974212360419E+01,
     &    0.584850295243816376E+00,
     &   -0.867214430569893047E+01,
     &    0.499777082922608418E+00,
     &   -0.284387629023282118E+01,
     &    0.340942803162901598E+01,
     &   -0.496020670766561267E+01,
     &    0.593381196773398845E+01,
     &    0.850620443138025012E-01,
     &   -0.337389997328944924E+01,
     &   -0.625185450225767525E+01,
     &    0.395416657840873653E+00,
     &   -0.105860475109899337E+02,
     &    0.550507085482184119E-01,
     &   -0.394639407157931443E+00,
     &   -0.398939587213936742E+00,
     &   -0.551295450351522831E+01,
     &    0.632416437038541113E+00,
     &   -0.123456120130034019E+01,
     &   -0.236739654905970331E+01,
     &   -0.241616141365753156E+01,
     &    0.563323041279608083E+00,
     &   -0.588539495598315554E+01,
     &    0.185605702920094456E+00,
     &   -0.566694527719728836E+00,
     &   -0.124636821409599419E+01,
     &   -0.147327008703184537E+01,
     &    0.539528334674538357E+01,
     &   -0.450940344660449011E+01,
     &    0.294300055318187925E+00,
     &    0.337738027780241756E+01,
     &   -0.169523767881331011E+01,
     &    0.623912960523836979E+01,
     &   -0.270525488909405842E+01,
     &    0.157827469545783750E+01,
     &   -0.212023160648839726E+01,
     &    0.473430498910560971E+01,
     &   -0.450726408785315957E+01,
     &   -0.444651406189911214E+01,
     &   -0.966193440921946234E+01,
     &   -0.300888706580633869E+01,
     &    0.348484244689903644E+01,
     &   -0.207895097847150012E+02,
     &   -0.468194101592870837E+00,
     &   -0.287337177838488911E+01,
     &   -0.611483284209996381E+01,
     &    0.263075092830496304E+01,
     &    0.153034790681060127E+02
     & /
      	data(wl2(i),i=1,n)/
     &   -0.403305889811271001E+02,
     &    0.200068322210646654E+01,
     &   -0.204361102727440276E+02,
     &   -0.316206306603993141E+02,
     &   -0.519930708112500528E+00,
     &   -0.205493295396332130E+02,
     &   -0.195881242688827371E+02,
     &   -0.481628413618603202E+00,
     &   -0.222816892388916471E+00,
     &   -0.147903461807474157E+00
     & /
      	data(b1(i),i=1,n)/
     &   -0.109790236221257747E+02,
     &    0.523012749841471880E+01,
     &   -0.106209273776926132E+02,
     &    0.118738670350820392E+02,
     &   -0.137873656798591959E+02,
     &    0.766465994741587231E+01,
     &    0.106560455204817295E+02,
     &   -0.131871586840867328E+01,
     &   -0.600737190141036503E+01,
     &   -0.529432006033550806E+01
     & /
      	data b2 / 0.811619788382313168E+01/
      	data(xmin(i),i=1,3)/
     &    0.140843083064814945E-02,
     &    0.219565773025097817E-06,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.496018527065587633E+00,
     &    0.246034379192315078E+00,
     &    0.669702295779823986E+00
     & /
      ymini=-0.113828903354402655E-01
      ymaxi= 0.839796744337549805E-01
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=28.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot

         end

      subroutine AB2PES_o_3(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 10,n= 10)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2
	data((wi(i,j),j=1,3),i=1,m)/
     &   -0.714708142937962171E-01,
     &   -0.302030501041400501E+00,
     &   -0.149996064232873616E+01,
     &    0.519757107349633207E+00,
     &   -0.262682039484654251E+01,
     &    0.399807660106439666E+01,
     &   -0.210477267629492282E+01,
     &    0.305416824871957815E+00,
     &   -0.164791354836370280E+00,
     &   -0.326537709281693594E-01,
     &    0.102538329844618881E+01,
     &    0.125683649080439303E+00,
     &    0.811497364929268272E+01,
     &   -0.562784636611656275E+01,
     &   -0.433948302900655947E+00,
     &   -0.499509260343319994E+01,
     &    0.327645376565365076E+01,
     &    0.290709911155841372E+01,
     &   -0.127481907081954260E+01,
     &    0.252833142355959462E+01,
     &   -0.293026677573783867E+00,
     &    0.817219517608904350E-01,
     &    0.204960791294913314E+01,
     &   -0.897060137531525692E+00,
     &    0.269968645238665601E-01,
     &    0.156586563153655711E+00,
     &    0.773712589989741595E+01,
     &    0.207111682173650363E+00,
     &   -0.220245831164446226E+01,
     &   -0.747992442460144402E+00
     & /
      	data(bbi(i),i=1,m)/
     &    0.248904362045383731E+01,
     &    0.312622318686730072E+01,
     &    0.108432433325409683E+01,
     &    0.379135316932477762E+00,
     &   -0.282904046641442974E+01,
     &   -0.696783369192015112E+00,
     &   -0.457713371084218834E+00,
     &    0.260087827729712062E+01,
     &   -0.314036595589818379E+01,
     &   -0.138545551298121583E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.113515174635343419E+01,
     &    0.222404279482409839E+01,
     &    0.144516684598254841E+01,
     &    0.536722705969084934E+01,
     &    0.806008060257776160E+00,
     &    0.403596277905018619E+00,
     &    0.241143721186585724E+00,
     &    0.354932697145096832E+01,
     &   -0.476749596948902887E+01,
     &    0.497013894770586440E+01,
     &    0.321299253438208465E+01,
     &   -0.121329052984030881E+02,
     &    0.182401108797187805E+01,
     &   -0.202917616141988499E+00,
     &   -0.247249832598351027E+01,
     &    0.458181297058968262E+00,
     &   -0.138299318558317896E+01,
     &   -0.423067309344177411E+00,
     &    0.538470035581243067E+01,
     &   -0.356639682743613129E+01,
     &    0.188719938786888797E+02,
     &   -0.790625276877914354E-02,
     &   -0.144336832483733124E+01,
     &   -0.240544305575263451E+01,
     &   -0.111276750683538705E+01,
     &    0.362073327727989991E+01,
     &   -0.105054124050674336E+01,
     &    0.511500481434169973E+01,
     &    0.585336464836404974E-01,
     &    0.161762255123184007E+01,
     &   -0.326691188054950921E+01,
     &    0.916666477666838020E+01,
     &   -0.125668047545053518E+02,
     &    0.335162273072410200E+01,
     &   -0.126161050303786326E+01,
     &    0.122950740758342603E+01,
     &   -0.577473671746001838E+01,
     &    0.249973404977515190E+00,
     &   -0.635189917901362033E+00,
     &    0.576152294200220361E+01,
     &    0.213353174049816863E+01,
     &    0.123527514003353271E+02,
     &    0.659291922835600364E+01,
     &    0.112592135659160313E+02,
     &    0.364446248946762674E+01,
     &   -0.824186054226511922E+00,
     &    0.297948676160654058E+01,
     &    0.342905511964574694E+00,
     &   -0.491174414474713572E+01,
     &    0.787999523740430785E+01,
     &    0.180944715348556109E+02,
     &    0.162200390430990948E+01,
     &   -0.956490532680037120E+01,
     &   -0.132369069326975151E+02,
     &    0.132488994552961092E+00,
     &    0.536733313140946944E+01,
     &   -0.342467150924911590E+00,
     &    0.798332379729344321E+01,
     &   -0.187018103321305224E+00,
     &   -0.576025544144290746E-01,
     &    0.953259019993216405E+01,
     &    0.216945280685119174E+00,
     &   -0.118403327594335050E+01,
     &   -0.197379071620789737E+01,
     &   -0.668003614802572421E+00,
     &    0.171641659110888489E+01,
     &   -0.444563139352908310E+00,
     &    0.339652668954433601E+01,
     &    0.111489841166964573E+00,
     &    0.176279368335705855E+01,
     &    0.181722926791805284E+01,
     &   -0.117428183894887450E+01,
     &    0.160694698626070775E+01,
     &    0.544294671986192302E+01,
     &    0.819184339156984409E+00,
     &    0.313474362322571032E+00,
     &    0.299932281828436453E+00,
     &    0.305832999619925205E+01,
     &   -0.463269640700472607E+01,
     &    0.469821968267776313E+01,
     &    0.107079997974227670E+02,
     &    0.188993778031659065E+01,
     &   -0.107652472605779685E+02,
     &   -0.166428392246918548E+02,
     &    0.342604836461359807E+00,
     &    0.217382214034143217E+01,
     &    0.319108641340294208E+00,
     &    0.465155522735878701E+01,
     &   -0.119501245379872251E+00,
     &   -0.133000008136875780E+01,
     &    0.993512744607195941E+01,
     &   -0.842512204492380845E+00,
     &   -0.754471316900576472E+01,
     &   -0.936436925237859441E+01,
     &   -0.932894854093554993E-01,
     &    0.528170003793064602E+01,
     &   -0.107820969709291758E+01,
     &    0.802248123323672502E+01,
     &   -0.300831760707983842E+00,
     &    0.103151353770514831E+01
     & /
      	data(wl2(i),i=1,n)/
     &    0.254737145055035308E+01,
     &   -0.741735239047330519E+00,
     &    0.703415220264372643E+00,
     &   -0.127871250108056000E+01,
     &   -0.555785037772940638E+00,
     &   -0.156234032543981911E+02,
     &   -0.117510539622765120E+01,
     &   -0.273167291249940813E+01,
     &    0.245916293888544635E+01,
     &    0.466444434679956055E+00
     & /
      	data(b1(i),i=1,n)/
     &   -0.772936466418197132E+00,
     &    0.737845150418093176E+00,
     &   -0.173044232974016587E+02,
     &    0.415083502444057295E+01,
     &   -0.713408501317694910E+01,
     &   -0.132746788714708437E+02,
     &   -0.802966470074021466E+01,
     &    0.204661164076741064E+01,
     &   -0.591651007745013668E+01,
     &   -0.613520225182426238E+01
     & /
      	data b2 / 0.136852291617904136E+02/
      	data(xmin(i),i=1,3)/
     &    0.140843083064814945E-02,
     &    0.219565773025097817E-06,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.496018527065587633E+00,
     &    0.246034379192315078E+00,
     &    0.669702295779823986E+00
     & /
      ymini=-0.113828903354402655E-01
      ymaxi= 0.839796744337549805E-01
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=28.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot

         end


      subroutine AB2PES_o_4(r,Vtot)
c	r(1),r(3)--AB
c	r(2)--B2
	implicit double precision (a-h,o-z)
	parameter (m= 10,n= 10)
	dimension r(3),wi(m,3),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension xmin(3),xmax(3),G(3),OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	external::VAB,VB2
	data((wi(i,j),j=1,3),i=1,m)/
     &    0.234487216593829917E+01,
     &   -0.353252915912419052E+01,
     &    0.358987617476080434E+01,
     &    0.210642696951678005E+00,
     &    0.106202860919333841E+01,
     &    0.178480585373061405E-01,
     &    0.470212731882402979E+00,
     &   -0.294548203359828731E+00,
     &    0.133029899112078542E+01,
     &   -0.101430099684025632E+01,
     &    0.102739017386008502E+01,
     &   -0.144765286551098278E+02,
     &    0.356017665220723245E+01,
     &   -0.940029192006073266E+00,
     &   -0.465078576342662017E-01,
     &   -0.206876609325153771E+01,
     &   -0.115193246138241112E+00,
     &    0.144947377715596765E+00,
     &    0.675159941756882365E+01,
     &   -0.358550652536168002E+01,
     &   -0.233813226618741932E+00,
     &    0.902537959261818457E+00,
     &   -0.589574569183542119E+00,
     &   -0.314198234945616806E+01,
     &    0.684992432697383302E+00,
     &    0.168043787862962302E+01,
     &    0.229958518236724113E+00,
     &    0.253399085311461914E+01,
     &   -0.179920767557176497E+01,
     &   -0.290441104893637014E+01
     & /
      	data(bbi(i),i=1,m)/
     &    0.284352799361571851E+01,
     &   -0.387779158252892775E+00,
     &   -0.414475010033184543E+00,
     &    0.681194672179421801E+01,
     &   -0.222716947692038847E+01,
     &   -0.687039865445708275E-01,
     &   -0.210579172722444952E+01,
     &    0.256431095308689294E+00,
     &    0.902916555615315586E+00,
     &    0.176380975001944695E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.257561790182291084E+01,
     &   -0.494716820308592897E+01,
     &    0.168617855087815194E+01,
     &    0.546846036292720439E+00,
     &    0.384524990852088822E+01,
     &   -0.714000692715432717E+01,
     &   -0.441991405069297283E+01,
     &    0.122818549239924590E+01,
     &   -0.389933656134201767E+01,
     &    0.481303940262541918E+00,
     &   -0.271874173095155180E+01,
     &   -0.519893976553768056E+01,
     &    0.184062295507715667E+01,
     &    0.466480180199564276E+00,
     &    0.445818099182445504E+01,
     &   -0.641669597321040541E+01,
     &   -0.401012431583396189E+01,
     &    0.129661982247429708E+01,
     &   -0.365179231259696158E+01,
     &    0.406616715602420464E+00,
     &   -0.255125648851785281E+01,
     &    0.146290180177100959E+01,
     &    0.268814082274403487E+01,
     &   -0.405829562607906258E+00,
     &   -0.387843170849481700E+01,
     &   -0.359940702983186922E+01,
     &   -0.214589446117413907E+01,
     &   -0.272209968872703190E+01,
     &   -0.115937606024344464E+01,
     &   -0.139662447956626579E+00,
     &   -0.443445305289895320E+01,
     &   -0.478846991217427664E+01,
     &   -0.908447920069148984E+00,
     &   -0.256905990354250635E+01,
     &    0.422135901200516983E+01,
     &    0.219551542174184888E+01,
     &   -0.262994950750511247E+01,
     &   -0.699482954174309768E+01,
     &    0.454947432557433018E+01,
     &   -0.358965916406518537E+00,
     &   -0.351945444396542184E+01,
     &   -0.535568296147206979E+01,
     &   -0.664676049159558469E+00,
     &   -0.248253163567015500E+01,
     &    0.504081040629219235E+01,
     &    0.227673843935591691E+01,
     &   -0.255701877510197795E+01,
     &   -0.661089771014896588E+01,
     &    0.458089157023802507E+01,
     &   -0.397814848345074468E+00,
     &    0.195082853969276560E+01,
     &    0.375328312778671624E+00,
     &    0.325801651772914225E+01,
     &   -0.408236526290260193E+00,
     &   -0.139486153552743031E+01,
     &   -0.301392616496250065E+01,
     &   -0.973671558231646528E+00,
     &    0.314167526215698767E+00,
     &   -0.755690157208112501E+00,
     &    0.128111808460196874E+00,
     &    0.603343223218859581E+01,
     &   -0.109423218574891501E+01,
     &   -0.694340388687009091E+00,
     &   -0.643057941232582864E+00,
     &    0.233204121268980913E+01,
     &   -0.603000475889849419E+01,
     &   -0.745333364880872651E+01,
     &    0.266065453831556609E+00,
     &    0.422559095638768056E+01,
     &    0.103291493205197171E+01,
     &    0.554268624498868689E+01,
     &   -0.579907798691289145E+01,
     &   -0.352248570714674436E+01,
     &    0.374673088218739014E+00,
     &    0.654957788659376572E+01,
     &    0.117956698148878925E+01,
     &    0.626192293774211373E+00,
     &   -0.212593819605139928E+00,
     &    0.119734288822888923E+01,
     &    0.122195387648304413E+00,
     &   -0.478779129972645201E+01,
     &    0.184547884926304445E+00,
     &    0.343288681139478147E+01,
     &   -0.381541519127706175E+00,
     &   -0.795039477219965263E+00,
     &   -0.162380764353549423E+01,
     &   -0.488194351318832320E+00,
     &    0.373700774916881528E+00,
     &   -0.292935023921885918E+00,
     &   -0.332002742980903945E-01,
     &   -0.900211199095066839E+01,
     &    0.134000348639114755E+02,
     &   -0.309015182942939015E+01,
     &   -0.702666682043386626E+01,
     &   -0.140587065270461160E+02,
     &   -0.458710591634906262E+01,
     &    0.137492709472129171E+01,
     &    0.628257562322088781E+01,
     &   -0.315512368202954363E+01,
     &   -0.235269938077340912E+01
     & /
      	data(wl2(i),i=1,n)/
     &   -0.391907390287397250E+01,
     &    0.655668298322250553E+01,
     &   -0.513068996273186251E+00,
     &   -0.355203244293223142E+01,
     &    0.355743823718504792E+01,
     &    0.508749559951064634E+00,
     &   -0.238027572022985634E+00,
     &   -0.711081305390776408E+00,
     &   -0.705646097814325635E+00,
     &    0.758545963305901783E+01
     & /
      	data(b1(i),i=1,n)/
     &    0.506580705314060631E+00,
     &    0.638230369161610689E+01,
     &   -0.481420373854367512E+01,
     &   -0.387715133209045648E+01,
     &   -0.410662524847338872E+01,
     &   -0.414289967091101907E+01,
     &   -0.104642306621941277E+02,
     &   -0.178684263701394763E+01,
     &    0.314564788327473410E+01,
     &   -0.799170092824262546E+00
     & /
      	data b2 / 0.395519171855010443E+01/
      	data(xmin(i),i=1,3)/
     &    0.140843083064814945E-02,
     &    0.219565773025097817E-06,
     &    0.247875217666635849E-02
     & /
      	data(xmax(i),i=1,3)/
     &    0.496018527065587633E+00,
     &    0.246034379192315078E+00,
     &    0.669702295779823986E+00
     & /
      ymini=-0.113828903354402655E-01
      ymaxi= 0.839796744337549805E-01
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p12=exp(-0.2*r(1))
       p23=exp(-0.2*r(2))
       p13=exp(-0.2*r(3))
       G(1)=(p12+p13)/2.0
       G(2)=p12*p13
       G(3)=p23
       G=2.0*(G - xmin)/(xmax - xmin) -1.0
       do it=1,m
		       c1(it)=0
		       do kt=1,3
			       c1(it)=c1(it)+Wi(it,kt)*G(kt)
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0/(1.0+exp(-2.0*c1))-1.0
       do it=1,n
       		c2(it)=0
	       	do kt=1,m
			       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0/(1.0+exp(-2.0*c2))-1.0
       c3=0.0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       v2tot=VAB(r(1))+VAB(r(3))+VB2(r(2))
       rd=28.0
       rw=0.5
       vtot=y2a*swifun(r(1),rd,rw)*swifun(r(2),rd,rw)
     &*swifun(r(3),rd,rw)+V2tot

         end



















      function VB2(r)
      implicit double precision (a-h,o-z)

       rmin=0.2
       rmax=25.0
        a=0.963897971
        b=-1.57790622
      	if(r.ge.rmax)then
	  call H2_NN(rmax,Vtot)
	elseif(r.le.rmin)then
        Vtot=a/abs(r)+b	
      else
        call H2_NN(r,Vtot)


      endif
      VB2=Vtot

      end
     
     



      subroutine H2_NN(r,Vtot)
	implicit double precision (a-h,o-z)
	parameter (m=  6,n=  6)
	dimension wi(m,1),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	data((wi(i,j),j=1,1),i=1,m)/
     &    0.187091988387795638E+02,
     &    0.281593160912371587E+01,
     &    0.108955238924849560E+02,
     &   -0.990670735700503258E+01,
     &   -0.802559290073134157E+01,
     &    0.524007373994077152E+01
     & /
      	data(bbi(i),i=1,m)/
     &   -0.204030110514350298E+02,
     &   -0.376233521245177371E+01,
     &   -0.389538145074145348E+01,
     &    0.273956254401250821E+01,
     &   -0.258691202278805221E+01,
     &    0.114575840868227647E+02
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.401281304969891561E+00,
     &    0.118793169810926069E+01,
     &   -0.128831525801254543E+01,
     &    0.804503912633640628E-01,
     &   -0.669828779562645221E-01,
     &   -0.133033846647576375E-01,
     &   -0.283301744699754110E+01,
     &    0.167653685062733593E+01,
     &   -0.355230278467456639E+00,
     &    0.834968891390923895E+00,
     &    0.122762598649082255E+01,
     &    0.924385993645828519E+00,
     &   -0.409208375985090134E+00,
     &    0.685756167299365149E+01,
     &    0.102153096760900408E+01,
     &   -0.319427515136290086E+00,
     &   -0.977282818490269989E+00,
     &    0.207133250750050957E+01,
     &   -0.435135607981412509E+01,
     &   -0.195464926036355102E+01,
     &    0.106853389663482723E+01,
     &   -0.415925666933415039E+00,
     &   -0.186431457410948664E+01,
     &   -0.457705257485948724E+01,
     &    0.877573144753894319E+01,
     &   -0.460676921167820907E+01,
     &   -0.116039607593005412E+00,
     &   -0.930525567480743887E+00,
     &   -0.140373245684308690E+01,
     &   -0.398325865878849827E+00,
     &   -0.402008292966389014E+00,
     &    0.149975253149356846E+01,
     &   -0.708339117256198025E+00,
     &   -0.308269531907514327E+00,
     &   -0.105843414302660777E+01,
     &   -0.333428148609567654E+00
     & /
      	data(wl2(i),i=1,n)/
     &   -0.330908197510536883E+01,
     &    0.256131894263348059E+01,
     &    0.335575381447763910E+01,
     &   -0.299878344631396665E+01,
     &    0.969939647893183832E+01,
     &    0.613017618174992629E-03
     & /
      	data(b1(i),i=1,n)/
     &   -0.299367545829914805E+01,
     &   -0.492881133128380444E+00,
     &    0.247177956925747955E+01,
     &   -0.456358900997748940E+01,
     &    0.168617204875353455E+01,
     &    0.231957945189295778E+01
     & /
      	data b2 / 0.327300796757159818E+01/
      	data xmin/
     &    0.820849986238988000E-01
     & /
      	data xmax /
     &    0.980198673306755253E+00
     & /
      ymini=-0.132477400000027501E+00
      ymaxi= 0.324158879999998817E+01
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p=exp(-0.1d0*r)
       G=2.0d0*(p - xmin)/(xmax - xmin) -1.0d0
       do it=1,m
		       c1(it)=0.d0
		       do kt=1,1
       c1(it)=c1(it)+Wi(it,kt)*G
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0d0/(1.0d0+exp(-2.0d0*c1))-1.0d0
       do it=1,n
       		c2(it)=0.d0
	       	do kt=1,m
       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0d0/(1.0d0+exp(-2.0d0*c2))+ymino
       c3=0.0d0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
         end

      function VAB(r)
      implicit double precision (a-h,o-z)

       rmin=0.8
       rmax=30.0
       rmid=2.55
       rmid_0=2.6
        a=6.4925112664
        b=-4.663743265
      	if(r.ge.rmax)then
	  call SH_Part2(rmax,Vtot)
	elseif(r.le.rmin)then
        Vtot=a/abs(r)+b	
      elseif(r.le.rmid)then
        call SH_Part1(r,V1)
        call SH_Part2(rmid_0,V2)
        Vtot=V1+V2
      elseif(r.gt.rmid)then
        call SH_Part2(r,Vtot)

      endif
      VAB=VTOT

      end


      subroutine SH_Part1(r,Vtot)
	implicit double precision (a-h,o-z)
	parameter (m=  5,n=  5)
	dimension wi(m,1),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	data((wi(i,j),j=1,1),i=1,m)/
     &   -0.548482983092981780E+01,
     &   -0.124080083522018381E+01,
     &   -0.773655145767474028E+01,
     &    0.645315895708919651E+01,
     &   -0.200344288219137834E+01
     & /
      	data(bbi(i),i=1,m)/
     &    0.735934527789077020E+01,
     &    0.178802738127258731E+01,
     &   -0.308674207138039725E+00,
     &    0.321620356682298336E+01,
     &   -0.179436212770362502E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &    0.189938013745641587E+01,
     &    0.113022233089406710E+01,
     &   -0.697856808819059982E+00,
     &   -0.734885687582660596E+00,
     &    0.215686727723476013E+01,
     &   -0.655113267221240969E+00,
     &   -0.120999704741434311E+01,
     &    0.325490943620250772E+00,
     &    0.668819764805730688E+00,
     &   -0.232541793466850499E+00,
     &    0.664034228055464193E+00,
     &   -0.920526182846879815E+00,
     &   -0.726107426107453158E+00,
     &    0.915782691281376793E+00,
     &   -0.546389525994201097E+00,
     &   -0.106025143032979230E+01,
     &    0.160124690048245721E+01,
     &    0.492111362623073645E+00,
     &    0.165422382514174932E+00,
     &   -0.906104945395673489E-01,
     &    0.465599532890010048E-01,
     &    0.180309393994797262E+01,
     &    0.336024817422481303E+00,
     &    0.451526606879638526E+00,
     &    0.174559539599533298E+01
     & /
      	data(wl2(i),i=1,n)/
     &    0.430765919450779911E+00,
     &    0.213230202203853914E+01,
     &   -0.803921383907935994E+00,
     &   -0.220550893028256834E+01,
     &   -0.186701203724820641E+01
     & /
      	data(b1(i),i=1,n)/
     &   -0.812949575992734985E+00,
     &    0.977199050265540325E+00,
     &   -0.130026032275861514E+00,
     &   -0.149803758539511067E+01,
     &    0.125846259808568095E+01
     & /
      	data b2 / 0.205803169331137320E+00/
      	data xmin/
     &    0.771051585803566253E+00
     & /
      	data xmax /
     &    0.923116346386635755E+00
     & /
      ymini=-0.438499999972918886E-03
      ymaxi= 0.359287150000000111E+01
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p=exp(-0.1d0*r)
       G=2.0d0*(p - xmin)/(xmax - xmin) -1.0d0
       do it=1,m
		       c1(it)=0.d0
		       do kt=1,1
       c1(it)=c1(it)+Wi(it,kt)*G
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0d0/(1.0d0+exp(-2.0d0*c1))-1.0d0
       do it=1,n
       		c2(it)=0.d0
	       	do kt=1,m
       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0d0/(1.0d0+exp(-2.0d0*c2))+ymino
       c3=0.0d0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
         end



      subroutine SH_Part2(r,Vtot)
	implicit double precision (a-h,o-z)
	parameter (m=  4,n=  4)
	dimension wi(m,1),bbi(m),wl1(n,m),wl2(n),b1(n)
	dimension OutLayer1(m),OutLayer2(n)
	dimension c1(m),c2(n)
	data((wi(i,j),j=1,1),i=1,m)/
     &    0.440522768911748219E+01,
     &   -0.505162197080995412E+01,
     &    0.357595379029961924E+01,
     &   -0.375059189637197266E+01
     & /
      	data(bbi(i),i=1,m)/
     &   -0.457872316946811253E+01,
     &    0.382592692243822796E+01,
     &    0.339134754357275567E-01,
     &   -0.722500407640886078E+01
     & /
      	data((wl1(i,j),j=1,m),i=1,n)/
     &   -0.119293993490524741E+01,
     &    0.257016678652499997E+00,
     &    0.311196707837981283E-02,
     &    0.147326166019954607E+01,
     &    0.260973356416367119E+01,
     &    0.188489460927971164E+01,
     &   -0.432245981750294161E+00,
     &   -0.192400878351373938E+01,
     &    0.381527990394434413E+00,
     &    0.172756167971310748E+01,
     &   -0.494895644792949507E+00,
     &    0.117627987889452568E+01,
     &    0.256499968126807920E+00,
     &    0.208252896638123630E+01,
     &   -0.563142681133694589E+00,
     &   -0.991014869857902325E+00
     & /
      	data(wl2(i),i=1,n)/
     &    0.179279275706860286E+01,
     &    0.143731365452591953E+01,
     &   -0.199966614810448551E+01,
     &    0.707437156048814741E+00
     & /
      	data(b1(i),i=1,n)/
     &    0.311831218709668623E+00,
     &   -0.618775582302063754E+00,
     &    0.330154443331599601E+00,
     &   -0.238586561778299089E+01
     & /
      	data b2 / 0.381032031475836863E+00/
      	data xmin/
     &    0.333732699603260657E-01
     & /
      	data xmax /
     &    0.778800783071404878E+00
     & /
      ymini=-0.138007000000015978E+00
      ymaxi= 0.000000000000000000E+00
      ymino=-0.100000000000000000E+01
      ymaxo= 0.100000000000000000E+01
       p=exp(-0.1d0*r)
       G=2.0d0*(p - xmin)/(xmax - xmin) -1.0d0
       do it=1,m
		       c1(it)=0.d0
		       do kt=1,1
       c1(it)=c1(it)+Wi(it,kt)*G
       end do
       end do
       c1=c1+bbi
       OutLayer1= 2.0d0/(1.0d0+exp(-2.0d0*c1))-1.0d0
       do it=1,n
       		c2(it)=0.d0
	       	do kt=1,m
       c2(it)=c2(it)+wl1(it,kt)*OutLayer1(kt)
       end do
       end do
       c2=c2+b1
       outlayer2= 2.0d0/(1.0d0+exp(-2.0d0*c2))+ymino
       c3=0.0d0
       do i=1,n
	       c3=c3+outlayer2(i)*wl2(i)
       end do
       c3=c3+b2
       y2a=(c3-ymino)*(ymaxi-ymini)/(ymaxo-ymino)+ymini
       vtot=y2a
         end
      function swifun(r,rd,rw)
       implicit double precision (a-h,o-z)
       swifun=1.0-0.5*(1.0+tanh((r-rd)/rw))
       return
       end